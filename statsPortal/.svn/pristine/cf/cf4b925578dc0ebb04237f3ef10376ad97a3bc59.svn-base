<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="wrStatsAnls">
	
	<!-- 샘플 조회 - 2018.09.13	ywKim	신규/변경 -->
	<select id="selectCommonCode" parameterType="hashmap" resultType="hashmap">	

		SELECT S_CLASS_CD, S_CLASS_CD_NM
		  FROM CMM_CD_COMCD
		 WHERE 1=1
		   AND B_CLASS_CD = #{b_class_cd}
		 ORDER BY S_CLASS_CD_ORDER

	</select>
	
	<select id="selectCurrendDate" parameterType="hashmap" resultType="hashmap">
		/* selectCurrendDate */
		SELECT TO_CHAR(SYSDATE, 'YYYYMM') AS CUR_MON
		     , TO_CHAR(SYSDATE, 'YYYY') AS CUR_YEAR
		     <!-- 2019-01-25 월 표시 => 년 표시로 수정. (prd_de = YYYYMM에서 YYYY로 변경) -->
			 <choose>
				<when test="Link_id == 'I3308' or Link_id == 'I3306' or Link_id == 'I3306_1'">
				, LEFT(MAX(PRD_DE),4) AS MAX_PRD_DE
				</when>
				<otherwise>
				, MAX(PRD_DE) AS MAX_PRD_DE
				</otherwise>
			</choose>
		  FROM SRV_DT_KOSIS_DATA
		<choose>
			<!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. -->
			<when test="Link_id == 'I3405' or Link_id == 'I3406'">
			WHERE LINK_ID = #{Link_id} AND ITM_ID = 'T10' <!-- 2020-04-22 [곽제욱] 수출, 수입 ITM_ID = 'T10' 으로 변경 -->
			</when>
			<when test="Link_id == 'I3306_1'">
			WHERE LINK_ID = 'I3306'
			</when>
			<otherwise>
			WHERE LINK_ID = #{Link_id}
			</otherwise>
		</choose>
	</select>
	
	<!-- 현재 년 기준 카테고리 -->
	<select id="selectDetailCategoryYear" parameterType="hashmap" resultType="hashmap">
	/*selectDetailCategoryYear*/
	SELECT TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') MON0
	     , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') MON1
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') MON2
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') MON3
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') MON4
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') MON5
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') MON6
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') MON7
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') MON8
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') MON9
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') MON10
		 , TO_CHAR(SYSDATE, 'YYYY') MON11
	  FROM DUAL
	</select>
	
	<!-- 현재 년 기준 + 특정월 카테고리 : 일자리 질 지표 중 일부사용(I3308 : 고용보험 가입률, I3306 : 비정규직 - 근로자 수, I3306_1 : 비정규직 - 근로자 비율) -->
	<select id="selectDetailCategoryYearAndMonth" parameterType="hashmap" resultType="hashmap">
	/*selectDetailCategoryYearAndMonth*/
	SELECT TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') || '08' MON0
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') || '08' MON1
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') || '08' MON2
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') || '08' MON3
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') || '08' MON4
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') || '08' MON5
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') || '08' MON6
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') || '08' MON7
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') || '08' MON8
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') || '08' MON9
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') || '08' MON10
		 , TO_CHAR(SYSDATE, 'YYYY') || '08' MON11
	  FROM DUAL
	</select>
	
	<!-- 현재 월 기준 카테고리 -->
	<select id="selectDetailCategoryMonth" parameterType="hashmap" resultType="hashmap">
	/*selectDetailCategoryMonth*/
	SELECT TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') MON0
	     , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') MON1
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') MON2
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') MON3
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') MON4
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') MON5
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') MON6
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') MON7
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') MON8
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') MON9
		 , TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') MON10
		 , TO_CHAR(SYSDATE, 'YYYYMM') MON11
	  FROM DUAL
	</select>
	
	<!-- 일자리현황 - 청년실업률용 현재 월 기준 분기 카테고리 -->
	<select id="selectDetailCategoryQuarter" parameterType="hashmap" resultType="hashmap">
	/*selectDetailCategoryQuarter*/
	SELECT TO_CHAR(SYSDATE, 'YYYY') || '년 4분기' AS MON11,
		   TO_CHAR(SYSDATE, 'YYYY') || '년 3분기' AS MON10,
		   TO_CHAR(SYSDATE, 'YYYY') || '년 2분기' AS MON9,
		   TO_CHAR(SYSDATE, 'YYYY') || '년 1분기' AS MON8,
		   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') || '년 4분기' AS MON7,
		   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') || '년 3분기' AS MON6,
		   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') || '년 2분기' AS MON5,
		   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') || '년 1분기' AS MON4,
		   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') || '년 4분기' AS MON3,
		   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') || '년 3분기' AS MON2,
		   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') || '년 2분기' AS MON1,
		   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') || '년 1분기' AS MON0
	  FROM DUAL
	</select>

<!-- 일자리현황 > 메인 -->	
<select id="selectSsaJobStatusMainData" parameterType="hashmap" resultType="hashmap">	

	SELECT TM_I3111 AS TM, rtrim(to_char((TM_I3111 - BFM_I3111), 'FM999999990D99'), '.')AS TOTAL, UNIT_NM, LINK_ID, LINK_NM
	FROM(
	SELECT
	NVL((SELECT DT FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3111'
	AND C1 = '00'
	AND ITM_ID = 'T90'
	AND PRD_DE = (SELECT TO_CHAR(TO_DATE(MAX(PRD_DE),'YYYYMM'),'YYYYMM') FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3111' AND C1 = '00' AND ITM_ID = 'T90')),0) TM_I3111,
	NVL((SELECT DT FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3111'
	AND C1 = '00'
	AND ITM_ID = 'T90'
	AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3111' AND C1 = '00' AND ITM_ID = 'T90')),0) BFM_I3111,
	(SELECT DISTINCT UNIT_NM
	FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3111'
	AND C1 = '00'
	AND ITM_ID = 'T90') UNIT_NM,
	'I3111' AS LINK_ID,
	'고용률' as LINK_NM
	FROM DUAL)
UNION ALL
SELECT TM_I3114 AS TM, rtrim(to_char((TM_I3114 - BFM_I3114), 'FM999999990D99'), '.') AS TOTAL, UNIT_NM, LINK_ID, LINK_NM
	FROM(
	SELECT
	NVL((SELECT DT FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3114'
	AND C1 = '00'
	AND C2 = '0'
	AND ITM_ID = 'T80'
	AND PRD_DE = (SELECT TO_CHAR(TO_DATE(MAX(PRD_DE),'YYYYMM'),'YYYYMM') FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3114' AND C1 = '00' AND C2 = '0' AND ITM_ID = 'T80')),0) TM_I3114,
	NVL((SELECT DT FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3114'
	AND C1 = '00'
	AND C2 = '0'
	AND ITM_ID = 'T80'
	AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3114' AND C1 = '00' AND C2 = '0' AND ITM_ID = 'T80')),0) BFM_I3114,
	(SELECT DISTINCT UNIT_NM
	FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3114'
	AND C1 = '00'
	AND C2 = '0'
	AND ITM_ID = 'T80') UNIT_NM,
	'I3114' AS LINK_ID,
	'실업률' as LINK_NM
	FROM DUAL)
UNION ALL
SELECT TM_I3116 AS TM, rtrim(to_char((TM_I3116 - BFM_I3116), 'FM999999990D99'), '.') AS TOTAL, UNIT_NM, LINK_ID, LINK_NM
	FROM(
	SELECT
	NVL((SELECT DT FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3116'
	AND C1 = '00'
	AND ITM_ID = 'T10'
	AND PRD_DE = (SELECT TO_CHAR(TO_DATE(MAX(PRD_DE),'YYYYMM'),'YYYYMM') FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3116' AND C1 = '00' AND ITM_ID = 'T10')),0) TM_I3116,
	NVL((SELECT DT FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3116'
	AND C1 = '00'
	AND ITM_ID = 'T10'
	AND PRD_DE = (SELECT MAX(PRD_DE) FROM SRV_DT_KOSIS_DATA
	               WHERE LINK_ID = 'I3116' AND C1 = '00' AND ITM_ID = 'T10' 
	                 AND PRD_DE != (SELECT MAX(PRD_DE) FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3116' AND C1 = '00' AND ITM_ID = 'T10'))),0) BFM_I3116,
	(SELECT DISTINCT UNIT_NM
	FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3116'
	AND C1 = '00'
	<!-- mng_s 20210119 이진호, 기존 T10 검색을 하였는데 2020년 기준 T80 값으로 데이터가 들어와 조건 추가--> 
	AND (ITM_ID = 'T10' or ITM_ID = 'T80')) UNIT_NM,
	'I3116' AS LINK_ID,
	'청년실업률' as LINK_NM
	FROM DUAL)
UNION ALL
SELECT TM_I3104 AS TM, rtrim(to_char((TM_I3104 - BFM_I3104), 'FM999999990D99'), '.') AS TOTAL, UNIT_NM, LINK_ID, LINK_NM
	FROM(
	SELECT
	NVL((SELECT DT FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3104'
	AND C1 = '00'
	AND C2 = '0'
	AND ITM_ID = 'T30'
	AND PRD_DE = (SELECT TO_CHAR(TO_DATE(MAX(PRD_DE),'YYYYMM'),'YYYYMM') FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3104' AND C1 = '00' AND C2 = '0' AND ITM_ID = 'T30')),0) TM_I3104,
	NVL((SELECT DT FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3104'
	AND C1 = '00'
	AND C2 = '0'
	AND ITM_ID = 'T30'
	AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3104' AND C1 = '00' AND C2 = '0' AND ITM_ID = 'T30')),0) BFM_I3104,
	(SELECT DISTINCT UNIT_NM
	FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3104'
	AND C1 = '00'
	AND C2 = '0'
	AND ITM_ID = 'T30') UNIT_NM,
	'I3104' AS LINK_ID,
	'취업자수' as LINK_NM
	FROM DUAL)
UNION ALL
SELECT TM_I3112 AS TM, rtrim(to_char((TM_I3112 - BFM_I3112), 'FM999999990D99'), '.') AS TOTAL, UNIT_NM, LINK_ID, LINK_NM
	FROM(
	SELECT
	NVL((SELECT DT FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3112'
	AND C1 = '00'
	AND C2 = '0'
	AND ITM_ID = 'T40'
	AND PRD_DE = (SELECT TO_CHAR(TO_DATE(MAX(PRD_DE),'YYYYMM'),'YYYYMM') FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3112' AND C1 = '00' AND C2 = '0' AND ITM_ID = 'T40')),0) TM_I3112,
	NVL((SELECT DT FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3112'
	AND C1 = '00'
	AND C2 = '0'
	AND ITM_ID = 'T40'
	AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3112' AND C1 = '00' AND C2 = '0' AND ITM_ID = 'T40')),0) BFM_I3112,
	(SELECT DISTINCT UNIT_NM
	FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3112'
	AND C1 = '00'
	AND C2 = '0'
	AND ITM_ID = 'T40') UNIT_NM,
	'I3112' AS LINK_ID,
	'실업자수' as LINK_NM
	FROM DUAL)
UNION ALL
SELECT TM_I3117 AS TM, rtrim(to_char((TM_I3117 - BFM_I3117), 'FM999999990D99'), '.') AS TOTAL, UNIT_NM, LINK_ID, LINK_NM
	FROM(
	SELECT
	NVL((SELECT DT FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3117'
	AND C1 = '00'
	AND C2 = '00'
	AND ITM_ID = 'T50'
	AND PRD_DE = (SELECT TO_CHAR(TO_DATE(MAX(PRD_DE),'YYYYMM'),'YYYYMM') FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3117' AND C1 = '00' AND C2 = '00' AND ITM_ID = 'T50')),0) TM_I3117,
	NVL((SELECT DT FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3117'
	AND C1 = '00'
	AND C2 = '00'
	AND ITM_ID = 'T50'
	AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3117' AND C1 = '00' AND C2 = '00' AND ITM_ID = 'T50')),0) BFM_I3117,
	(SELECT DISTINCT UNIT_NM
	FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3117'
	AND C1 = '00'
	AND C2 = '00'
	AND ITM_ID = 'T50') UNIT_NM,
	'I3117' AS LINK_ID,
	'비경제활동인구' as LINK_NM
	FROM DUAL)
UNION ALL
SELECT TM_I3101 AS TM, rtrim(to_char((TM_I3101 - BFM_I3101), 'FM999999990D99'), '.') AS TOTAL, UNIT_NM, LINK_ID, LINK_NM
	FROM(
	SELECT
	NVL((SELECT DT FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3101'
	AND C1 = '00'
	AND ITM_ID = 'T1'
	AND PRD_DE = (SELECT TO_CHAR(TO_DATE(MAX(PRD_DE),'YYYYMM'),'YYYYMM') FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3101' AND C1 = '00' AND ITM_ID = 'T1')),0) TM_I3101,
	NVL((SELECT DT FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3101'
	AND C1 = '00'
	AND ITM_ID = 'T1'
	AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3101' AND C1 = '00' AND ITM_ID = 'T1')),0) BFM_I3101,
	(SELECT DISTINCT UNIT_NM
	FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3101'
	AND C1 = '00'
	AND ITM_ID = 'T1') UNIT_NM,
	'I3101' AS LINK_ID,
	'세대수' as LINK_NM
	FROM DUAL)
</select>

<!-- 일자리현황 > 메인 차트 -->
<select id="selectSsaJobStatusMainChart" parameterType="hashmap" resultType="hashmap">	

	SELECT CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON1,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON2,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON3,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON4,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON5,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON6,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON7,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON8,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON9,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON10,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON11,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON12,
		   LINK_ID,
		   '고용률' as LINK_NM,
		   PRD_DE,
		   UNIT_NM
	FROM SRV_DT_KOSIS_DATA
	where LINK_ID = 'I3111'
	AND C1 = '00'
	AND ITM_ID = 'T90'
	UNION ALL
	SELECT CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON1,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON2,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON3,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON4,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON5,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON6,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON7,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON8,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON9,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON10,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON11,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON12,
		   LINK_ID,
		   '실업률' as LINK_NM,
		   PRD_DE,
		   UNIT_NM
	FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3114'
	AND C1 = '00'
	AND C2 = '0'
	AND ITM_ID = 'T80'
	UNION ALL
	SELECT CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') || '04' THEN DT ELSE 0 END MON1,
		   CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') || '03' THEN DT ELSE 0 END MON2,
		   CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') || '02' THEN DT ELSE 0 END MON3,
		   CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') || '01' THEN DT ELSE 0 END MON4,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') || '04' THEN DT ELSE 0 END MON5,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') || '03' THEN DT ELSE 0 END MON6,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') || '02' THEN DT ELSE 0 END MON7,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') || '01' THEN DT ELSE 0 END MON8,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') || '04' THEN DT ELSE 0 END MON9,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') || '03' THEN DT ELSE 0 END MON10,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') || '02' THEN DT ELSE 0 END MON11,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') || '01' THEN DT ELSE 0 END MON12,
		   LINK_ID,
		   '청년실업률' as LINK_NM,
		   PRD_DE,
		   UNIT_NM
	FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3116'
	AND C1 = '00'
	AND ITM_ID = 'T10'
	UNION ALL
	SELECT CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON1,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON2,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON3,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON4,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON5,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON6,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON7,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON8,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON9,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON10,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON11,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON12,
		   LINK_ID,
		   '취업자수' as LINK_NM,
		   PRD_DE,
		   UNIT_NM
	FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3104'
	AND C1 = '00'
	AND C2 = '0'
	AND ITM_ID = 'T30'
	UNION ALL
	SELECT CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON1,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON2,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON3,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON4,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON5,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON6,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON7,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON8,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON9,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON10,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON11,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON12,
		   LINK_ID,
		   '실업자수' as LINK_NM,
		   PRD_DE,
		   UNIT_NM
	FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3112'
	AND C1 = '00'
	AND C2 = '0'
	AND ITM_ID = 'T40'
	UNION ALL
	SELECT CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON1,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON2,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON3,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON4,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON5,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON6,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON7,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON8,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON9,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON10,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON11,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON12,
		   LINK_ID,
		   '비경제활동인구' as LINK_NM,
		   PRD_DE,
		   UNIT_NM
	FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3117'
	AND C1 = '00'
	AND C2 = '00'
	AND ITM_ID = 'T50'
	UNION ALL
	SELECT CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON1,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON2,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON3,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON4,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON5,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON6,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON7,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON8,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON9,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON10,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON11,
		   CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON12,
		   LINK_ID,
		   '세대수' as LINK_NM,
		   PRD_DE,
		   UNIT_NM
	FROM SRV_DT_KOSIS_DATA
	WHERE LINK_ID = 'I3101'
	AND C1 = '00'
	AND ITM_ID = 'T1'

</select>

<!-- 일자리현황 > 메인 > 선택팝업 > 현재(월 기준) 카테고리 -->
<select id="selectSsaDetailCategory" parameterType="hashmap" resultType="hashmap">
SELECT TO_CHAR(SYSDATE, 'YYYYMM') AS MON11,
	   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') AS MON10,
	   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') AS MON9,
	   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') AS MON8,
	   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') AS MON7,
	   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') AS MON6,
	   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') AS MON5,
	   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') AS MON4,
	   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') AS MON3,
	   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') AS MON2,
	   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') AS MON1,
	   TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') AS MON0
FROM DUAL
</select>

<!-- 일자리현황 > 메인 > 선택팝업 > 상세 데이터 -->
<select id="selectSsaDetailData" parameterType="hashmap" resultType="hashmap">
  SELECT *
    FROM SRV_DT_KOSIS_DATA
   WHERE LINK_ID = #{Link_id}
   		<choose>
		 	<when test="Link_id == 'I3114'">	<!-- 실업률 -->
		 		AND C2 = #{Cx} 
		 	</when>
		 	<when test="Link_id == 'I3115'">	<!-- 실업률 -->
		 		AND C3 = #{Cx}
		 	</when>
		 	<when test="Link_id == 'I3104'">	<!-- 취업자수 -->
		 		AND C2 = #{Cx}
		 	</when>
		 	<when test="Link_id == 'I3105'">	<!-- 취업자수 -->
		 		AND C2 = #{Cx}
		 	</when>
		 	<when test="Link_id == 'I3106'">	<!-- 취업자수 -->
		 		AND C2 = #{Cx}
		 	</when>
		 	<when test="Link_id == 'I3107'">	<!-- 취업자수 -->
		 		AND C2 = #{Cx}
		 	</when>
		 	<when test="Link_id == 'I3108'">	<!-- 취업자수 -->
		 		AND C2 = #{Cx}
		 	</when>
		 	<when test="Link_id == 'I3109'">	<!-- 취업자수 -->
		 		AND C2 = #{Cx}
		 	</when>
		 	<when test="Link_id == 'I3110'">	<!-- 취업자수 -->
		 		AND C2 = #{Cx}
		 	</when>
		 	<when test="Link_id == 'I3112'">	<!-- 실업자수 -->
		 		AND C2 = #{Cx}
		 	</when>
		 	<when test="Link_id == 'I3113'">	<!-- 실업자수 -->
		 		AND C3 = #{Cx}
		 	</when>
		 	<when test="Link_id == 'I3117'">	<!-- 비경제활동인구 -->
		 		AND C2 = #{Cx}
		 	</when>
		 	<when test="Link_id == 'I3102'">	<!-- 인구 -->
		 		AND ITM_ID = #{Cx}
		 	</when>
		 	<when test="Link_id == 'I3103'">	<!-- 인구 -->
		 		AND ITM_ID = #{Cx}
		 		AND C2 = '00'
		 	</when>
		 </choose>
		 <choose>
		 	<when test="Link_id == 'I3116'">	<!-- 청년실업률 -->
		 		AND PRD_DE BETWEEN TO_CHAR (ADD_MONTHS (TO_DATE (SYSDATE), -24),'YYYY')||'01'
				AND TO_CHAR (SYSDATE, 'YYYY')||'04'
		 	</when>
		 	<otherwise>
				AND PRD_DE BETWEEN TO_CHAR (ADD_MONTHS (TO_DATE (SYSDATE), -11),'YYYYMM')
				AND TO_CHAR (SYSDATE, 'YYYYMM')
		 	</otherwise>
		 </choose>
ORDER BY C1, PRD_DE DESC, C2
</select>

	<!-- 일자리현황 > 메인 > 지표 타이틀 팁 -->
	<select id="selectSsaindicatorTitle" parameterType="hashmap" resultType="hashmap">
	SELECT *
	  FROM SRV_DT_JOB_STAT_DATA_INFO
	</select>

	<!-- 일자리통계분석 - 일자리증감 메인 지표 -->
	<select id="selectSsaJobGrowthMain" parameterType="hashmap" resultType="hashmap">
		/*selectSsaJobGrowthMain*/
		SELECT '34' AS SECTION
			 , '고용보험 신규취득자수' AS ITM_NM /* 2020-07-23 [곽제욱] 통계명 변경(고용보험 증감 -> 고용보험 신규취득자수) */
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		/*  FROM (
				SELECT 'E3224' AS LINK_ID
					 , (E3222.DT - E3223.DT) AS DT
					 , E3222.UNIT_NM AS UNIT_NM
					 , E3222.PRD_DE AS PRD_DE
					 , E3222.C1 AS C1
					 , E3222.C1_NM AS C1_NM
				  FROM (SELECT * 
						  FROM SRV_DT_KOSIS_DATA 
						 WHERE LINK_ID = 'E3222' 
						   AND ITM_ID = 'T40'
						   AND C1 = '00'
						   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
					   ) E3222
					 , (SELECT * 
					      FROM SRV_DT_KOSIS_DATA 
					     WHERE LINK_ID = 'E3223' 
						   AND ITM_ID = 'T50'
						   AND C1 = '00'
						   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
					   ) E3223 
				 WHERE E3222.PRD_DE = E3223.PRD_DE
				   AND E3222.C1 = E3223.C1
				   AND E3222.C1 = '00'
				   AND E3222.PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3222')
			   ) A
			 , (
				SELECT 'E3224' AS LINK_ID
					 , (E3222.DT - E3223.DT) AS DT
					 , E3222.UNIT_NM AS UNIT_NM
					 , E3222.PRD_DE AS PRD_DE
					 , E3222.C1 AS C1
					 , E3222.C1_NM AS C1_NM
				  FROM (SELECT * 
						  FROM SRV_DT_KOSIS_DATA 
						 WHERE LINK_ID = 'E3222' 
						   AND ITM_ID = 'T40'
						   AND C1 = '00'
						   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
					   ) E3222
					 , (SELECT * 
					      FROM SRV_DT_KOSIS_DATA 
					     WHERE LINK_ID = 'E3223' 
						   AND ITM_ID = 'T50'
						   AND C1 = '00'
						   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
					   ) E3223 
				 WHERE E3222.PRD_DE = E3223.PRD_DE
				   AND E3222.C1 = E3223.C1
				   AND E3222.C1 = '00'
				   AND E3222.PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3222')
			   ) B*/
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
		   <!-- 2020-04.13[곽제욱] 피보험자증감 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경, AND C2 조건 추가) START -->
			     WHERE 1=1 AND LINK_ID = 'E3224' AND C1 = '00' AND ITM_ID = 'T10' AND C2 = '0'
				   AND PRD_DE = (SELECT TO_CHAR(TO_DATE(MAX(PRD_DE),'yyyymm')-1,'yyyymm') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3224')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3224' AND C1 = '00' AND ITM_ID = 'T10' AND C2 = '0'
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3224')
		   <!-- 2020-04.13[곽제욱] 피보험자증감 KOSIS 연계로 인한 조건절 수정 END -->
		 UNION ALL  
		SELECT '34' AS SECTION
		     , '취업자 증감' AS ITM_NM
		     , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'I3220' AND C1 = '00' AND ITM_ID = 'T14' 
				   AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3220')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3220' AND C1 = '00' AND ITM_ID = 'T14' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3220')
		 UNION ALL 
		SELECT '34' AS SECTION
		     , '구직건수' AS ITM_NM
		     , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'E3218' AND C1 = '00' AND ITM_ID = 'T70' 
				   AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3218')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3218' AND C1 = '00' AND ITM_ID = 'T70' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3218')
		 UNION ALL 
		SELECT '34' AS SECTION
		     , '구인 인원' AS ITM_NM
		     , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'E3208' AND C1 = '00' AND ITM_ID = 'T10' 
				   AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3208')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3208' AND C1 = '00' AND ITM_ID = 'T10' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3208')
		 UNION ALL 
		SELECT '34' AS SECTION
		     , '폐업 수' AS ITM_NM
		     , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
   		<!-- 2019.11.04[한광희] 폐업 수 값 비교 오류로 인한 수정 START -->
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT 
		     	  FROM SRV_DT_KOSIS_DATA
				 WHERE 1=1
				   AND LINK_ID = 'I3207'
				   AND C1 = '00'
				   AND ITM_ID = 'T001'
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3207')
			   ) B
   		<!-- 2019.11.04[한광희] 폐업 수 값 비교 오류로 인한 수정 END -->
		 WHERE 1=1 AND LINK_ID = 'I3207' AND C1 = '00' AND ITM_ID = 'T001' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3207')
		 UNION ALL 
		SELECT '34' AS SECTION
		     , '신설 수' AS ITM_NM
		     , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'I3206' AND C1 = '00' AND ITM_ID = '16142T1' 
				   AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3206')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3206' AND C1 = '00' AND ITM_ID = '16142T1' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3206')
	</select>
	
	<!-- 일자리통계분석 - 일자리증감 메인 차트 -->
	<select id="selectSsaJobGrowthMainChart" parameterType="hashmap" resultType="hashmap">
		/* selectSsaJobGrowthMainChart */
		SELECT CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN A.DT ELSE 0 END MON1
		     , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN A.DT ELSE 0 END MON2
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN A.DT ELSE 0 END MON3
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN A.DT ELSE 0 END MON4
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN A.DT ELSE 0 END MON5
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN A.DT ELSE 0 END MON6
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN A.DT ELSE 0 END MON7
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN A.DT ELSE 0 END MON8
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN A.DT ELSE 0 END MON9
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN A.DT ELSE 0 END MON10
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN A.DT ELSE 0 END MON11
			 , CASE WHEN A.PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN A.DT ELSE 0 END MON12
			 , A.LINK_ID AS LINK_ID, '고용보험 신규취득자수' AS LINK_NM /* 2020-07-23 [곽제욱] 통계명 변경(고용보험 증감 -> 고용보험 신규취득자수) */
			 , A.PRD_DE 
			 , A.UNIT_NM
		  FROM /*(SELECT '34' AS SECTION
					 , '고용보험 증감' AS ITM_NM
					 , 'E3224' AS LINK_ID
					 , (E3222.DT - E3223.DT) AS DT
					 , E3222.UNIT_NM AS UNIT_NM
					 , E3222.PRD_DE AS PRD_DE
					 , E3222.C1 AS C1
					 , E3222.C1_NM AS C1_NM
				  FROM (SELECT * 
						  FROM SRV_DT_KOSIS_DATA 
						 WHERE LINK_ID = 'E3222' 
						   AND ITM_ID = 'T40'
						   AND C1 = '00'
						   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
					   ) E3222
					 , (SELECT * 
						  FROM SRV_DT_KOSIS_DATA 
						 WHERE LINK_ID = 'E3223' 
						   AND ITM_ID = 'T50'
						   AND C1 = '00'
						   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
					   ) E3223 
				 WHERE E3222.PRD_DE = E3223.PRD_DE
				   AND E3222.C1 = E3223.C1
				   AND E3222.C1 = '00'
				   AND E3222.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
			   )*/ 
			   SRV_DT_KOSIS_DATA A
		 WHERE A.LINK_ID = 'E3224' /*E3222 : 고용보험 신규취득자, E3223 : 고용보험 상실자, E3224 : 고용보험 증감*/
		   AND A.C1 = '00' 
		   <!-- 2020-04.13[곽제욱] 피보험자증감 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경, AND C2 조건 추가) START -->
		   AND A.ITM_ID = 'T10' 
		   AND A.C2 = '0'
		   <!-- 2020-04.13[곽제욱] 피보험자증감 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경, AND C2 조건 추가) END -->
		   AND A.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		 UNION ALL 
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON12
			 , LINK_ID, '취업자 증감' AS LINK_NM
			 , PRD_DE 
			 , UNIT_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'I3220' /*E3219 : 취업자증감(지역별 취업건수), E3220 : 취업자증감*/
		   AND C1 = '00'
		   AND ITM_ID = 'T14' 
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		 UNION ALL 
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON12
			 , LINK_ID, '구직건수' AS LINK_NM
			 , PRD_DE 
			 , UNIT_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'E3218' 
		   AND C1 = '00' 
		   AND ITM_ID = 'T70'
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		 UNION ALL 
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON12
			 , LINK_ID, '구인 인원' AS LINK_NM
			 , PRD_DE 
			 , UNIT_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'E3208' 
		   AND C1 = '00' 
		   AND ITM_ID = 'T10' 
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		 UNION ALL 
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
		     , LINK_ID, '폐업 수' AS LINK_NM
			 , PRD_DE 
			 , UNIT_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'I3207' 
		   AND C1 = '00'  
		   AND ITM_ID = 'T001' 
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		 UNION ALL 
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON12
			 , LINK_ID, '신설 수' AS LINK_NM
			 , PRD_DE 
			 , UNIT_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'I3206' 
		   AND C1 = '00' 
		   AND ITM_ID = '16142T1' 
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
	</select>
	
	<!-- 일자리통계분석 - 일자리 증감 상세 지표 -->
	<select id="selectSsaJobGrowthDetail" parameterType="hashmap" resultType="hashmap">
		/*selectSsaJobGrowthDetail*/
		<if test="Link_id != null and Link_id == 'E3224'">
		SELECT '34' AS SECTION
			 , '고용보험 신규취득자수' AS ITM_NM /* 2020-07-23 [곽제욱] 통계명 변경(고용보험 증감 -> 고용보험 신규취득자수) */ 
			 , A.LINK_ID AS LINK_ID
			 , A.DT AS DT
			 , A.UNIT_NM AS UNIT_NM
			 , A.C1 AS C1
			 , A.C1_NM AS C1_NM
			 , A.PRD_DE AS PRD_DE
			 , B.DT AS PRE_DT
		  /*FROM (
				SELECT 'E3224' AS LINK_ID
					 , (E3222.DT - E3223.DT) AS DT
					 , E3222.UNIT_NM AS UNIT_NM
					 , E3222.PRD_DE AS PRD_DE
					 , E3222.C1 AS C1
					 , E3222.C1_NM AS C1_NM
				  FROM (SELECT * 
					  FROM SRV_DT_KOSIS_DATA 
					 WHERE LINK_ID = 'E3222' 
					   AND ITM_ID = 'T40'
					   AND C1 = '00'
					   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
					) E3222
					  , (SELECT * 
						   FROM SRV_DT_KOSIS_DATA 
						  WHERE LINK_ID = 'E3223' 
							AND ITM_ID = 'T50'
							AND C1 = '00'
							AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
					) E3223 
				 WHERE E3222.PRD_DE = E3223.PRD_DE
				   AND E3222.C1 = E3223.C1
				   AND E3222.C1 = '00'
				   AND E3222.PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3222')
			   ) A
			 , (
				SELECT 'E3224' AS LINK_ID
					 , (E3222.DT - E3223.DT) AS DT
					 , E3222.UNIT_NM AS UNIT_NM
					 , E3222.PRD_DE AS PRD_DE
					 , E3222.C1 AS C1
					 , E3222.C1_NM AS C1_NM
				  FROM (SELECT * 
					  FROM SRV_DT_KOSIS_DATA 
					 WHERE LINK_ID = 'E3222' 
					   AND ITM_ID = 'T40'
					   AND C1 = '00'
					   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
					) E3222
					  , (SELECT * 
						   FROM SRV_DT_KOSIS_DATA 
						  WHERE LINK_ID = 'E3223' 
							AND ITM_ID = 'T50'
							AND C1 = '00'
							AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
					) E3223 
				 WHERE E3222.PRD_DE = E3223.PRD_DE
				   AND E3222.C1 = E3223.C1
				   AND E3222.C1 = '00'
				   AND E3222.PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3222')
			   ) B*/
			   FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
     	 <!-- 2020-04.13[곽제욱] 피보험자증감 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경, AND C2 조건 추가) START -->
			     WHERE 1=1 AND LINK_ID = 'E3224' AND C1 = '00' AND ITM_ID = 'T10' 
			     AND C2 = #{Cx} 
				   AND PRD_DE = (SELECT TO_CHAR(TO_DATE(MAX(PRD_DE),'yyyymm')-1,'yyyymm') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3224')
				
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3224' AND C1 = '00' AND ITM_ID = 'T10' AND C2 = #{Cx}
		 <!-- 2020-04.13[곽제욱] 피보험자증감 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경, AND C2 조건 추가) END --> 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3224')
		</if>
		<if test="Link_id != null and Link_id == 'I3220'">
		SELECT '34' AS SECTION
		     , '취업자 증감' AS ITM_NM
		     , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'I3220' AND C1 = '00' AND ITM_ID = 'T14' 
				   AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3220')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3220' AND C1 = '00' AND ITM_ID = 'T14' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3220')
		</if>
		<if test="Link_id != null and Link_id == 'E3218'"> 
		SELECT '34' AS SECTION
		     , '구직건수' AS ITM_NM
		     , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'E3218' AND C1 = '00' AND ITM_ID = 'T70' 
				   AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3218')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3218' AND C1 = '00' AND ITM_ID = 'T70' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3218')
		</if>  
		<if test="Link_id != null and Link_id == 'E3208'"> 
		SELECT '34' AS SECTION
		     , '구인 인원' AS ITM_NM
		     , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'E3208' AND C1 = '00' AND ITM_ID = 'T10' 
				   AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3208')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3208' AND C1 = '00' AND ITM_ID = 'T10' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3208')
		</if>
		<if test="Link_id != null and Link_id == 'I3207'"> 
		SELECT '34' AS SECTION
		     , '폐업 수' AS ITM_NM
		     , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE LINK_ID = 'I3207' AND C1 = '00' AND ITM_ID = 'T001' 
				   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE 
				                   FROM SRV_DT_KOSIS_DATA 
								  WHERE LINK_ID = 'I3207' 
								    AND C1 = '00' 
									AND ITM_ID = 'T001' 
				                    AND prd_de != (select max(prd_de) from srv_dt_kosis_data where LINK_ID = 'I3207' AND C1 = '00' AND ITM_ID = 'T001'))
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3207' AND C1 = '00' AND ITM_ID = 'T001' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3207')
		</if>
		<if test="Link_id != null and Link_id == 'I3206'"> 
		SELECT '34' AS SECTION
		     , '신설 수' AS ITM_NM
		     , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'I3206' AND C1 = '00' AND ITM_ID = '16142T1' 
				   AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3206')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3206' AND C1 = '00' AND ITM_ID = '16142T1' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3206')
		</if>
	</select>
	
	<!-- 일자리통계분석 - 일자리 증감 상세 차트 -->
	<select id="selectSsaJobGrowthDetailChart" parameterType="hashmap" resultType="hashmap">
		/* selectSsaJobGrowthMainChart */
		<if test="Link_id != null and Link_id == 'E3224'">
		SELECT CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN A.DT ELSE 0 END MON1
		     , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN A.DT ELSE 0 END MON2
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN A.DT ELSE 0 END MON3
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN A.DT ELSE 0 END MON4
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN A.DT ELSE 0 END MON5
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN A.DT ELSE 0 END MON6
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN A.DT ELSE 0 END MON7
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN A.DT ELSE 0 END MON8
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN A.DT ELSE 0 END MON9
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN A.DT ELSE 0 END MON10
			 , CASE WHEN A.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN A.DT ELSE 0 END MON11
			 , CASE WHEN A.PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN A.DT ELSE 0 END MON12
			 , A.LINK_ID AS LINK_ID, '고용보험 신규취득자수' AS LINK_NM /* 2020-07-23 [곽제욱] 통계명 변경(고용보험 증감 -> 고용보험 신규취득자수) */
			 , A.PRD_DE 
			 , A.UNIT_NM
			 , A.C1
			 , A.C1_NM
		  /* FROM (SELECT '34' AS SECTION
			     , '고용보험 증감' AS ITM_NM
			     , 'E3224' AS LINK_ID
			     , (E3222.DT - E3223.DT) AS DT
			     , E3222.UNIT_NM AS UNIT_NM
			     , E3222.PRD_DE AS PRD_DE
			     , E3222.C1 AS C1
			     , E3222.C1_NM AS C1_NM
			  FROM (SELECT * 
				  FROM SRV_DT_KOSIS_DATA 
				 WHERE LINK_ID = 'E3222' 
				   AND ITM_ID = 'T40'
				   AND C1 = '00'
				   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
			       ) E3222
			     , (SELECT * 
				  FROM SRV_DT_KOSIS_DATA 
				 WHERE LINK_ID = 'E3223' 
				   AND ITM_ID = 'T50'
				   AND C1 = '00'
				   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
			       ) E3223 
			 WHERE E3222.PRD_DE = E3223.PRD_DE
			   AND E3222.C1 = E3223.C1
			   AND E3222.C1 = '00'
			   AND E3222.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		       ) A
		 WHERE A.LINK_ID = 'E3224'
		   AND A.C1 = '00' 
		   AND A.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		   */
		   FROM SRV_DT_KOSIS_DATA A		     
		 <!-- 2020-04.13[곽제욱] 피보험자증감 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경, AND C2 조건 추가) START -->
		 WHERE 1=1 AND LINK_ID = 'E3224' AND C1 = '00' AND ITM_ID = 'T10' AND C2 = #{Cx} 
		 <!-- 2020-04.13[곽제욱] 피보험자증감 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경, AND C2 조건 추가) END -->
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') and TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'I3220'"> 
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON12
			 , LINK_ID, '취업자 증감' as LINK_NM
			 , PRD_DE 
			 , UNIT_NM
			 , C1
			 , C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'I3220' /*E3219 : 취업자증감(지역별 취업건수), I3220 : 취업자증감*/
		   AND C1 = '00'
		   AND ITM_ID = 'T14' 
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') and TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'E3218'"> 
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON12
			 , LINK_ID, '구직건수' as LINK_NM
			 , PRD_DE 
			 , UNIT_NM
			 , C1
			 , C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'E3218' 
		   AND C1 = '00' 
		   AND ITM_ID = 'T70'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') and TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'E3208'"> 
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON12
			 , LINK_ID, '구인 인원' as LINK_NM
			 , PRD_DE 
			 , UNIT_NM
			 , C1
			 , C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'E3208' 
		   AND C1 = '00' 
		   AND ITM_ID = 'T10' 
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') and TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'I3207'"> 
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
		     , LINK_ID, '폐업 수' as LINK_NM
			 , PRD_DE 
			 , UNIT_NM
			 , C1
			 , C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'I3207' 
		   AND C1 = '00'  
		   AND ITM_ID = 'T001' 
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'I3206'">
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON12
			 , LINK_ID, '신설 수' as LINK_NM
			 , PRD_DE 
			 , UNIT_NM
			 , C1
			 , C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'I3206' 
		   AND C1 = '00' 
		   AND ITM_ID = '16142T1' 
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') and TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
	</select>
	
	<!-- 일자리증감 - 상세 데이터보드 -->
	<select id="selectSsaJobGrowthDetailDataBoard" parameterType="hashmap" resultType="hashmap">	
		/* selectSsaJobGrowthDetailDataBoard */
		<if test="Link_id != null and Link_id == 'E3224'">
		SELECT '34' AS SECTION
			 , '고용보험 신규취득자수' AS ITM_NM /* 2020-07-23 [곽제욱] 통계명 변경(고용보험 증감 -> 고용보험 신규취득자수) */
			 , LINK_ID AS LINK_ID
			 , TRIM(NVL(DT, '0')) AS DT
			 , UNIT_NM AS UNIT_NM
			 , C1 AS C1
			 , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  /*FROM (
				SELECT 'E3224' AS LINK_ID
					 , (E3222.DT - E3223.DT) AS DT
					 , E3222.UNIT_NM AS UNIT_NM
					 , E3222.PRD_DE AS PRD_DE
					 , E3222.C1 AS C1
					 , E3222.C1_NM AS C1_NM
				  FROM (SELECT * 
					  FROM SRV_DT_KOSIS_DATA 
					 WHERE LINK_ID = 'E3222' 
					   AND ITM_ID = 'T40'
					   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
					) E3222
					  , (SELECT * 
						   FROM SRV_DT_KOSIS_DATA 
						  WHERE LINK_ID = 'E3223' 
							AND ITM_ID = 'T50'
							AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
					) E3223 
				 WHERE E3222.PRD_DE = E3223.PRD_DE
				   AND E3222.C1 = E3223.C1
				   AND E3222.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
			   )*/
		  FROM SRV_DT_KOSIS_DATA
		 <!-- 2020-04.13[곽제욱] 피보험자증감 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경, AND C2 조건 추가) START --> 
		 WHERE 1=1 AND LINK_ID = 'E3224' AND ITM_ID = 'T10' 
		 AND C2 = #{Cx}
		 <!-- 2020-04.13[곽제욱] 피보험자증감 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경, AND C2 조건 추가) END -->
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'I3220'">
		SELECT '34' AS SECTION
		     , '취업자 증감' AS ITM_NM
		     , LINK_ID AS LINK_ID
		     , TRIM(NVL(DT, '0')) AS DT
		     , UNIT_NM AS UNIT_NM
		     , C1 AS C1
		     , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE 1=1 AND LINK_ID = 'I3220' AND ITM_ID = 'T14' 
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'E3218'">
		SELECT '34' AS SECTION
		     , '구직건수' AS ITM_NM
		     , LINK_ID AS LINK_ID
		     , TRIM(NVL(DT, '0')) AS DT
		     , UNIT_NM AS UNIT_NM
		     , C1 AS C1
		     , C1_NM AS C1_NM
		     , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE 1=1 AND LINK_ID = 'E3218' AND ITM_ID = 'T70' 
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'E3208'">
		SELECT '34' AS SECTION
		     , '구인 인원' AS ITM_NM
		     , LINK_ID AS LINK_ID
		     , TRIM(NVL(DT, '0')) AS DT
		     , UNIT_NM AS UNIT_NM
		     , C1 AS C1
		     , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE 1=1 AND LINK_ID = 'E3208' AND ITM_ID = 'T10' 
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'I3207'">
		SELECT '34' AS SECTION
		     , '폐업 수' AS ITM_NM
		     , LINK_ID AS LINK_ID
		     , TRIM(NVL(DT, '0')) AS DT
		     , UNIT_NM AS UNIT_NM
		     , C1 AS C1
		     , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE 1=1 AND LINK_ID = 'I3207' AND ITM_ID = 'T001'
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'I3206'">
		SELECT '34' AS SECTION
		     , '신설 수' AS ITM_NM
		     , LINK_ID AS LINK_ID
		     , TRIM(NVL(DT, '0')) AS DT
		     , UNIT_NM AS UNIT_NM
		     , C1 AS C1
		     , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE 1=1 AND LINK_ID = 'I3206' AND ITM_ID = '16142T1' 
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
	</select>
	
	<!-- 일자리질 > 현황조회 메인 > 집계 -->
	<select id="getStatsAnlsJobQualityMain" parameterType="hashmap" resultType="hashmap">	
		/* getStatsAnlsJobQualityMain */
		SELECT '33' AS SECTION
			 , '산업재해 전체 재해율' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04.14[곽제욱] 산업재해 전체 재해율 KOSIS 연계로 인한 조건절 수정(ITM_ID = '16118AAD6_15118AI8ACAB' AND C1 = '15118AI700' 변경) START -->
			     WHERE 1=1 AND LINK_ID = 'E3309' AND ITM_ID = '16118AAD6_15118AI8ACAB' AND C1 = '15118AI700' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3309')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3309' AND ITM_ID = '16118AAD6_15118AI8ACAB' AND C1 = '15118AI700' 
		 <!-- 2020-04.14[곽제욱] 산업재해 전체 재해율 KOSIS 연계로 인한 조건절 수정(ITM_ID = '16118AAD6_15118AI8ACAB' AND C1 = '15118AI700' 변경) END -->
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3309')
		 UNION ALL
		SELECT '33' AS SECTION
			 , '고용보험 가입률' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'I3308' AND ITM_ID = 'T50' AND C1 = '00' 
				   AND PRD_DE = (SELECT SUBSTR(MAX(PRD_DE), 1, 4) -1 || SUBSTR(MAX(PRD_DE), 5, 2) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3308')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3308' AND ITM_ID = 'T50' AND C1 = '00' 
		   AND PRD_DE = (SELECT SUBSTR(MAX(PRD_DE), 1, 4) || SUBSTR(MAX(PRD_DE), 5, 2) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3308')
		 UNION ALL
		SELECT '33' AS SECTION
			 , '총 근로시간' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04.14[곽제욱] 총 근로시간 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index2', C1 = '00' 변경) START -->
			     WHERE 1=1 AND LINK_ID = 'E3307' AND ITM_ID = 'index2' AND C1 = '00'  
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3307')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3307' AND ITM_ID = 'index2' AND C1 = '00' 
		 <!-- 2020-04.14[곽제욱] 총 근로시간 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index2', C1 = '00' 변경) END -->
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3307')
		 UNION ALL
		SELECT '33' AS SECTION
			 , '근로자 수' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'I3306' AND ITM_ID = 'T03' AND C1 = '00'
				   AND PRD_DE = (SELECT SUBSTR(MAX(PRD_DE), 1, 4) -1 || SUBSTR(MAX(PRD_DE), 5, 2) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3306')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3306' AND ITM_ID = 'T03' AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3306')
		 UNION ALL
		SELECT '33' AS SECTION
			 , '근로자 비율' AS ITM_NM
			 , 'I3306_1' AS LINK_ID
			 , A.DT AS DT
			 , '%' AS UNIT_NM
			 , '00' AS C1
			 , '계' AS C1_NM
			 , B.DT AS PRE_DT
		  FROM (SELECT TO_CHAR(TRUNC(T03.DT / T01.DT * 100, 1)) AS DT
				  FROM (
						SELECT PRD_DE, DT
						  FROM SRV_DT_KOSIS_DATA 
						 WHERE LINK_ID = 'I3306' AND ITM_ID = 'T01' AND C1 = '00' 
						   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3306')
						) T01
						LEFT JOIN (
						SELECT PRD_DE, DT
						  FROM SRV_DT_KOSIS_DATA 
						 WHERE LINK_ID = 'I3306' AND ITM_ID = 'T03' AND C1 = '00' 
						   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3306')
						) T03 ON T01.PRD_DE = T03.PRD_DE
				) A
		     , (SELECT TO_CHAR(TRUNC(T03.DT / T01.DT * 100, 1)) AS DT
				  FROM (
						SELECT PRD_DE, DT
						  FROM SRV_DT_KOSIS_DATA 
						 WHERE LINK_ID = 'I3306' AND ITM_ID = 'T01' AND C1 = '00' 
						   AND PRD_DE = (SELECT SUBSTR(MAX(PRD_DE), 1, 4) -1 || SUBSTR(MAX(PRD_DE), 5, 2) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3306')
						) T01
						LEFT JOIN (
						SELECT PRD_DE, DT
						  FROM SRV_DT_KOSIS_DATA 
						 WHERE LINK_ID = 'I3306' AND ITM_ID = 'T03' AND C1 = '00' 
						   AND PRD_DE = (SELECT SUBSTR(MAX(PRD_DE), 1, 4) -1 || SUBSTR(MAX(PRD_DE), 5, 2) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3306')
						) T03 ON T01.PRD_DE = T03.PRD_DE
				) B
		 UNION ALL
		SELECT '33' AS SECTION
			 , '임금상승률' AS ITM_NM <!-- 2020-05-21 [곽제욱] 저임금 근로자 비율 -> 임금상승률 로 변경 -->
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04.14[곽제욱] 저임금 근로자 비율 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T002' 변경) START -->
			     WHERE 1=1 AND LINK_ID = 'E3303' AND ITM_ID = 'T002' AND C1 = '00'
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3303')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3303' AND ITM_ID = 'T002' AND C1 = '00' 
		 <!-- 2020-04.14[곽제욱] 저임금 근로자 비율 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T002' 변경) END -->
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3303')
		 UNION ALL
		SELECT '33' AS SECTION 
			 , '평균임금총액' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
	     <!-- 2020-04.14[곽제욱] 평균임금총액 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index6', C1 = '00' 변경) START -->
			     WHERE 1=1 AND LINK_ID = 'E3301' AND ITM_ID = 'index6' AND C1 = '00'  
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3301')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3301' AND ITM_ID = 'index6' AND C1 = '00'
		 <!-- 2020-04.14[곽제욱] 평균임금총액 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index6', C1 = '00' 변경) END --> 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3301')
	</select>
	
	<!-- 일자리질 > 현황조회 메인 > 차트 -->
	<select id="getStatsAnlsJobQualityMainChart" parameterType="hashmap" resultType="hashmap">	
		/*getStatsAnlsJobQualityMainChart*/
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID, '산업재해 전체 재해율' AS LINK_NM
			 , PRD_DE 
			 , UNIT_NM
		  FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04.14[곽제욱] 산업재해 전체 재해율 KOSIS 연계로 인한 조건절 수정(ITM_ID = '16118AAD6_15118AI8ACAB' AND C1 = '15118AI700' 변경) START -->
		 WHERE LINK_ID = 'E3309' AND ITM_ID = '16118AAD6_15118AI8ACAB' AND C1 = '15118AI700' 
		 <!-- 2020-04.14[곽제욱] 산업재해 전체 재해율 KOSIS 연계로 인한 조건절 수정(ITM_ID = '16118AAD6_15118AI8ACAB' AND C1 = '15118AI700' 변경) END -->
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		 UNION ALL 
		SELECT CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN T_I3308.DT ELSE 0 END MON1
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN T_I3308.DT ELSE 0 END MON2
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN T_I3308.DT ELSE 0 END MON3
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN T_I3308.DT ELSE 0 END MON4
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN T_I3308.DT ELSE 0 END MON5
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN T_I3308.DT ELSE 0 END MON6
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN T_I3308.DT ELSE 0 END MON7
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN T_I3308.DT ELSE 0 END MON8
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN T_I3308.DT ELSE 0 END MON9
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN T_I3308.DT ELSE 0 END MON10
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN T_I3308.DT ELSE 0 END MON11
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN T_I3308.DT ELSE 0 END MON12
			 , T_I3308.LINK_ID, '고용보험 가입률' AS LINK_NM
			 , T_I3308.PRD_DE 
			 , A.UNIT_NM
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT
			         , LINK_ID
					 , SUBSTR(PRD_DE, 1, 4) PRD_DE
					 , PRD_DE AS O_PRD_DE
				  FROM SRV_DT_KOSIS_DATA 
				 WHERE LINK_ID = 'I3308'
				   AND C1 = '00'
				   AND ITM_ID = 'T50' 
				   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
				) T_I3308
		 WHERE A.PRD_DE = T_I3308.O_PRD_DE
		   AND A.LINK_ID = 'I3308'
		   AND A.C1 = '00'
		   AND A.ITM_ID = 'T50' 
		   AND A.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		 UNION ALL 
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID, '총 근로시간' AS LINK_NM
			 , PRD_DE 
			 , UNIT_NM
		  FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04.14[곽제욱] 총 근로시간 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index2', C1 = '00' 변경) START -->
		 WHERE LINK_ID = 'E3307' AND ITM_ID = 'index2' AND C1 = '00' 
		 <!-- 2020-04.14[곽제욱] 총 근로시간 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index2', C1 = '00' 변경) END -->
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		 UNION ALL 
		SELECT CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN T_I3306.DT ELSE 0 END MON1
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN T_I3306.DT ELSE 0 END MON2
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN T_I3306.DT ELSE 0 END MON3
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN T_I3306.DT ELSE 0 END MON4
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN T_I3306.DT ELSE 0 END MON5
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN T_I3306.DT ELSE 0 END MON6
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN T_I3306.DT ELSE 0 END MON7
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN T_I3306.DT ELSE 0 END MON8
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN T_I3306.DT ELSE 0 END MON9
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN T_I3306.DT ELSE 0 END MON10
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN T_I3306.DT ELSE 0 END MON11
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN T_I3306.DT ELSE 0 END MON12
			 , T_I3306.LINK_ID, '근로자 수' AS LINK_NM
			 , T_I3306.PRD_DE 
			 , A.UNIT_NM
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT
			         , LINK_ID
					 , SUBSTR(PRD_DE, 1, 4) PRD_DE
					 , PRD_DE AS O_PRD_DE
				  FROM SRV_DT_KOSIS_DATA 
				 WHERE LINK_ID = 'I3306'
				   AND C1 = '00'
				   AND ITM_ID = 'T03' 
				   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
				) T_I3306
		 WHERE A.PRD_DE = T_I3306.O_PRD_DE
		   AND A.LINK_ID = 'I3306' 
		   AND A.ITM_ID = 'T03' 
		   AND A.C1 = '00' 
		   AND A.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		 UNION ALL 
		SELECT CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN T_I3306.DT ELSE 0 END MON1
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN T_I3306.DT ELSE 0 END MON2
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN T_I3306.DT ELSE 0 END MON3
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN T_I3306.DT ELSE 0 END MON4
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN T_I3306.DT ELSE 0 END MON5
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN T_I3306.DT ELSE 0 END MON6
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN T_I3306.DT ELSE 0 END MON7
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN T_I3306.DT ELSE 0 END MON8
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN T_I3306.DT ELSE 0 END MON9
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN T_I3306.DT ELSE 0 END MON10
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN T_I3306.DT ELSE 0 END MON11
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN T_I3306.DT ELSE 0 END MON12
			 , T_I3306.LINK_ID, '근로자 비율' AS LINK_NM
			 , T_I3306.PRD_DE 
			 , '%' AS UNIT_NM
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT TRUNC((NON_REGULAR.DT / TOTAL.DT) * 100, 1) DT
					 , 'I3306_1' AS LINK_ID
					 , SUBSTR(S.PRD_DE, 1, 4) PRD_DE
					 , S.PRD_DE AS O_PRD_DE
				  FROM SRV_DT_KOSIS_DATA S
					 , (SELECT DT, PRD_DE FROM SRV_DT_KOSIS_DATA 
						 WHERE 1=1 AND LINK_ID = 'I3306' AND ITM_ID = 'T01' AND C1 = '00') TOTAL
					 , (SELECT DT, PRD_DE FROM SRV_DT_KOSIS_DATA 
						 WHERE 1=1 AND LINK_ID = 'I3306' AND ITM_ID = 'T03' AND C1 = '00') NON_REGULAR
				 WHERE S.PRD_DE = TOTAL.PRD_DE
				   AND TOTAL.PRD_DE = NON_REGULAR.PRD_DE
				   AND S.LINK_ID = 'I3306'
				   AND S.C1 = '00'
				   AND S.ITM_ID = 'T03' 
				   AND S.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
				) T_I3306
		 WHERE A.PRD_DE = T_I3306.O_PRD_DE
		   AND A.LINK_ID = 'I3306' 
		   AND A.ITM_ID = 'T03' 
		   AND A.C1 = '00' 
		   AND A.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		 UNION ALL 
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID, '임금상승률' AS LINK_NM <!-- 2020-05-21 [곽제욱] 저임금 근로자 비율 -> 임금상승률 로 변경 -->
			 , PRD_DE 
			 , UNIT_NM
		  FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04.14[곽제욱] 저임금 근로자 비율 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T002' 변경) START -->
		 WHERE LINK_ID = 'E3303' AND ITM_ID = 'T002' AND C1 = '00'
		 <!-- 2020-04.14[곽제욱] 저임금 근로자 비율 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T002' 변경) START --> 
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		 UNION ALL 
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON12
			 , LINK_ID, '평균임금총액' AS LINK_NM
			 , PRD_DE 
			 , UNIT_NM
		  FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04.14[곽제욱] 평균임금총액 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index6', C1 = '00' 변경) START -->
		 WHERE LINK_ID = 'E3301' AND ITM_ID = 'index6' AND C1 = '00'
		 <!-- 2020-04.14[곽제욱] 평균임금총액 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index6', C1 = '00' 변경) END --> 
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
	</select>
	
	<!-- 일자리질 > 현황조회 메인 > 데이터보드 -->
	<select id="getStatsAnlsJobQualityMainDataBoard" parameterType="hashmap" resultType="hashmap">
		/*getStatsAnlsJobQualityMainDataBoard*/
		<if test="Link_id != null and Link_id == 'E3309'">
		select '33' as section
			 , '산업재해 전체 재해율' as itm_nm
			 , link_id as link_id
			 , dt as dt
			 , unit_nm as unit_nm
			 , c1 as c1
			 , c1_nm as c1_nm
			 , prd_de as prd_de
		  from srv_dt_kosis_data 
		 <!-- 2020-04.14[곽제욱] 산업재해 전체 재해율 KOSIS 연계로 인한 조건절 수정(ITM_ID = '16118AAD6_15118AI8ACAB' 변경) START -->
		 where 1=1 and link_id = 'E3309' and itm_id = '16118AAD6_15118AI8ACAB'
		 <!-- 2020-04.14[곽제욱] 산업재해 전체 재해율 KOSIS 연계로 인한 조건절 수정(ITM_ID = '16118AAD6_15118AI8ACAB' 변경) END -->
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		 order by prd_de
		</if>
		<!-- 2019-01-25 월 표시 => 년 표시로 수정. (prd_de = YYYYMM에서 YYYY로 변경) -->
		<if test="Link_id != null and Link_id == 'I3308'">
		select '33' as section
			 , '고용보험 가입률' as itm_nm
			 , A.link_id as link_id
			 , A.dt as dt
			 , A.unit_nm as unit_nm
			 , A.c1 as c1
			 , A.c1_nm as c1_nm
			 , T_I3308.prd_de as prd_de
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT
					 , LINK_ID
					 , SUBSTR(PRD_DE, 1, 4) PRD_DE
					 , PRD_DE AS O_PRD_DE
					 , c1
					 , c1_nm
				  FROM SRV_DT_KOSIS_DATA 
				 WHERE LINK_ID = 'I3308'
				   AND ITM_ID = 'T50' 
				   AND C1 = '00' 
				   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
				) T_I3308
		 WHERE A.PRD_DE = T_I3308.O_PRD_DE
		   AND A.LINK_ID = 'I3308'
		   AND A.ITM_ID = 'T50' 
		   and a.c1 = T_I3308.c1
		   AND T_I3308.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'E3307'">
		<!-- 2020-04.14[곽제욱] 총 근로시간 시도별 Map 표출을 위한 수정 START -->
		select '33' as section
			 , '총 근로시간' as itm_nm
			 , A.link_id as link_id
			 , A.dt as dt
			 , A.unit_nm as unit_nm
			 , A.c1 as c1
			 , A.c1_nm as c1_nm
			 , T_E3307.prd_de as prd_de
		  from srv_dt_kosis_data A,
				(SELECT DT
					 , LINK_ID
					 , SUBSTR(PRD_DE, 1, 4) PRD_DE
					 , PRD_DE AS O_PRD_DE
					 , c1
					 , c1_nm
				  FROM SRV_DT_KOSIS_DATA 
				 WHERE LINK_ID = 'E3307'
				   AND ITM_ID = 'index2' 
				   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
				) T_E3307
		 where A.PRD_DE = T_E3307.O_PRD_DE
		   AND A.LINK_ID = 'E3307' 
		   AND A.ITM_ID = 'index2' 
		   and A.c1 = T_E3307.c1
		   AND T_E3307.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		<!-- 2020-04.14[곽제욱] 총 근로시간 시도별 Map 표출을 위한 수정 END -->
		</if>
		<!-- 2019-01-25 월 표시 => 년 표시로 수정. (prd_de = YYYYMM에서 YYYY로 변경) -->
		<if test="Link_id != null and Link_id == 'I3306'">
		select '33' as section
			 , '근로자 수' as itm_nm
			 , A.link_id as link_id
			 , A.dt as dt
			 , A.unit_nm as unit_nm
			 , A.c1 as c1
			 , A.c1_nm as c1_nm
			 , T_I3306.prd_de as prd_de
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT
					 , LINK_ID
					 , SUBSTR(PRD_DE, 1, 4) PRD_DE
					 , PRD_DE AS O_PRD_DE
					 , c1
					 , c1_nm
				  FROM SRV_DT_KOSIS_DATA 
				 WHERE LINK_ID = 'I3306'
				   AND ITM_ID = 'T03' 
				   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
				) T_I3306
		 WHERE A.PRD_DE = T_I3306.O_PRD_DE
		   AND A.LINK_ID = 'I3306' 
		   AND A.ITM_ID = 'T03' 
		   and a.c1 = T_I3306.c1
		   AND T_I3306.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<!-- 2019-01-25 월 표시 => 년 표시로 수정. (prd_de = YYYYMM에서 YYYY로 변경) -->
		<if test="Link_id != null and Link_id == 'I3306_1'">
		select '33' as section
			 , '근로자 비율' as itm_nm
			 , 'I3306_1' as link_id
			 , dt as dt
			 , '%' as unit_nm
			 , x.c1 as c1
			 , x.c1_nm as c1_nm
		     , x.prd_de as prd_de 
		  from (select to_char(TRUNC(t03.dt / t01.dt * 100, 1)) as dt
					 , t01.c1
					 , t01.c1_nm
					 , SUBSTR(t01.PRD_DE, 1, 4) PRD_DE
					 , t01.PRD_DE AS O_PRD_DE
				  from (
						select prd_de, dt, c1, c1_nm
						  from srv_dt_kosis_data 
						 where link_id = 'I3306' and itm_id = 'T01' 
						) t01
					    LEFT JOIN (
						select prd_de, dt, c1, c1_nm
						  from srv_dt_kosis_data 
						 where link_id = 'I3306' and itm_id = 'T03' 
						) t03 
					 ON t01.prd_de = t03.prd_de and t01.c1 = t03.c1 
				    and t01.prd_de BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
			   ) x
		 where x.prd_de BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'E3303'">
		<!-- 2020-04.14[곽제욱] 저임금 근로자 비율 KOSIS 연계로 인한 쿼리 수정(시도별 조회 추가) START -->
		select '33' as section
			 , '임금상승률' as itm_nm <!-- 2020-05-21 [곽제욱] 저임금 근로자 비율 -> 임금상승률 로 변경 -->
			 , A.link_id as link_id
			 , A.dt as dt
			 , A.unit_nm as unit_nm
			 , A.c1 as c1
			 , A.c1_nm as c1_nm
			 , T_E3303.prd_de as prd_de
		  from srv_dt_kosis_data A,
				(SELECT DT
					 , LINK_ID
					 , SUBSTR(PRD_DE, 1, 4) PRD_DE
					 , PRD_DE AS O_PRD_DE
					 , c1
					 , c1_nm
				  FROM SRV_DT_KOSIS_DATA 
				 WHERE LINK_ID = 'E3303'
				   AND ITM_ID = 'T002' 
				   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
				) T_E3303
		 where A.PRD_DE = T_E3303.O_PRD_DE
		   AND A.LINK_ID = 'E3303' 
		   AND A.ITM_ID = 'T002' 
		   and A.c1 = T_E3303.c1
           AND T_E3303.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
        <!-- 2020-04.14[곽제욱] 저임금 근로자 비율 KOSIS 연계로 인한 쿼리 수정(시도별 조회 추가) END -->
		</if>
		<if test="Link_id != null and Link_id == 'E3301'">
		<!-- 2020-04.14[곽제욱] 평균임금총액 KOSIS 연계로 인한 쿼리 수정(시도별 조회 추가) START -->
		select '33' as section
			 , '평균임금총액' as itm_nm
			 , A.link_id as link_id
			 , REPLACE(A.DT, ',', '') AS DT
			 , A.unit_nm as unit_nm
			 , A.c1 as c1
			 , A.c1_nm as c1_nm
			 , T_E3301.prd_de as prd_de
		  from srv_dt_kosis_data A,
				(SELECT DT
					 , LINK_ID
					 , SUBSTR(PRD_DE, 1, 4) PRD_DE
					 , PRD_DE AS O_PRD_DE
					 , c1
					 , c1_nm
				  FROM SRV_DT_KOSIS_DATA 
				 WHERE LINK_ID = 'E3301'
				   AND ITM_ID = 'index6' 
				   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
				) T_E3301
		 where A.PRD_DE = T_E3301.O_PRD_DE
		   AND A.LINK_ID = 'E3301' 
		   AND A.ITM_ID = 'index6' 
		   and A.c1 = T_E3301.c1
		   AND T_E3301.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		 <!-- 2020-04.14[곽제욱] 평균임금총액 KOSIS 연계로 인한 쿼리 수정(시도별 조회 추가) END -->
		</if>
	</select>
	
	<!-- 일자리질 > 현황조회 상세 > 집계 -->
	<select id="getStatsAnlsJobQualityDetail" parameterType="hashmap" resultType="hashmap">	
		/*getStatsAnlsJobQualityDetail*/
		<if test="Link_id != null and Link_id == 'E3309'">
		SELECT '33' AS SECTION
			 , '산업재해 전체 재해율' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , A.PRD_DE AS PRD_DE
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04.14[곽제욱] 산업재해 전체 재해율 KOSIS 연계로 인한 조건절 수정(ITM_ID = '16118AAD6_15118AI8ACAB' AND C1 = '15118AI700' 변경) START -->
			     WHERE 1=1 AND LINK_ID = 'E3309' AND ITM_ID = '16118AAD6_15118AI8ACAB' AND C1 = '15118AI700' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3309')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3309' AND ITM_ID = '16118AAD6_15118AI8ACAB' AND C1 = '15118AI700'
		 <!-- 2020-04.14[곽제욱] 산업재해 전체 재해율 KOSIS 연계로 인한 조건절 수정(ITM_ID = '16118AAD6_15118AI8ACAB' AND C1 = '15118AI700' 변경) END --> 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3309')
		</if>
		<if test="Link_id != null and Link_id == 'I3308'">
		SELECT '33' AS SECTION
			 , '고용보험 가입률' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
		     , A.PRD_DE AS PRD_DE
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'I3308' AND ITM_ID = 'T50' AND C1 = '00' 
				   AND PRD_DE = (SELECT SUBSTR(MAX(PRD_DE), 1, 4) -1 || SUBSTR(MAX(PRD_DE), 5, 2) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3308')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3308' AND ITM_ID = 'T50' AND C1 = '00' 
		   AND PRD_DE = (SELECT SUBSTR(MAX(PRD_DE), 1, 4) || SUBSTR(MAX(PRD_DE), 5, 2) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3308')
		</if>
		<if test="Link_id != null and Link_id == 'E3307'">
		SELECT '33' AS SECTION
			 , '총 근로시간' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
		     , A.PRD_DE AS PRD_DE
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA
		 <!-- 2020-04.14[곽제욱] 총 근로시간 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index2', C1 = '00' 변경) START --> 
			     WHERE 1=1 AND LINK_ID = 'E3307' AND ITM_ID = 'index2' AND C1 = '00' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3307')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3307' AND ITM_ID = 'index2' AND C1 = '00'
		 <!-- 2020-04.14[곽제욱] 총 근로시간 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index2', C1 = '00' 변경) END --> 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3307')
		</if>
		<if test="Link_id != null and Link_id == 'I3306'">
		SELECT '33' AS SECTION
			 , '근로자 수' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
		     , A.PRD_DE AS PRD_DE
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-07.24[곽제욱] 근로자수 조건절 원복 START -->
			     WHERE 1=1 AND LINK_ID = 'I3306' AND ITM_ID = 'T03' AND C1 = '00'
				   AND PRD_DE = (SELECT SUBSTR(MAX(PRD_DE), 1, 4) -1 || SUBSTR(MAX(PRD_DE), 5, 2) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3306')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3306' AND ITM_ID = 'T03' AND C1 = '00'
		 <!-- 2020-07.24[곽제욱] 근로자수 조건절 원복 END -->
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3306')
		</if>
		<if test="Link_id != null and Link_id == 'I3306_1'">
		SELECT '33' AS SECTION
			 , '근로자 비율' AS ITM_NM
			 , 'I3306_1' AS LINK_ID
			 , A.DT AS DT
			 , '%' AS UNIT_NM
			 , '00' AS C1
			 , '계' AS C1_NM
			 , A.PRD_DE AS PRD_DE
			 , B.DT AS PRE_DT
		  FROM (SELECT TO_CHAR(TRUNC(T03.DT / T01.DT * 100, 1)) AS DT
		  			 , T01.PRD_DE AS PRD_DE
				  FROM (
						SELECT PRD_DE, DT
						  FROM SRV_DT_KOSIS_DATA 
						 WHERE LINK_ID = 'I3306' AND ITM_ID = 'T01' AND C1 = '00' 
						   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3306')
						) T01
						LEFT JOIN (
						SELECT PRD_DE, DT
						  FROM SRV_DT_KOSIS_DATA 
						 WHERE LINK_ID = 'I3306' AND ITM_ID = 'T03' AND C1 = '00' 
						   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3306')
						) T03 ON T01.PRD_DE = T03.PRD_DE
				) A
		     , (SELECT TO_CHAR(TRUNC(T03.DT / T01.DT * 100, 1)) AS DT
				  FROM (
						SELECT PRD_DE, DT
						  FROM SRV_DT_KOSIS_DATA 
						 WHERE LINK_ID = 'I3306' AND ITM_ID = 'T01' AND C1 = '00' 
						   AND PRD_DE = (SELECT SUBSTR(MAX(PRD_DE), 1, 4) -1 || SUBSTR(MAX(PRD_DE), 5, 2) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3306')
						) T01
						LEFT JOIN (
						SELECT PRD_DE, DT
						  FROM SRV_DT_KOSIS_DATA 
						 WHERE LINK_ID = 'I3306' AND ITM_ID = 'T03' AND C1 = '00' 
						   AND PRD_DE = (SELECT SUBSTR(MAX(PRD_DE), 1, 4) -1 || SUBSTR(MAX(PRD_DE), 5, 2) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3306')
						) T03 ON T01.PRD_DE = T03.PRD_DE
				) B
		</if>
		<if test="Link_id != null and Link_id == 'E3303'">
		SELECT '33' AS SECTION
			 , '임금상승률' AS ITM_NM <!-- 2020-05-21 [곽제욱] 저임금 근로자 비율 -> 임금상승률 로 변경 -->
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04.14[곽제욱] 저임금 근로자 비율 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T002' 변경) START -->
			     WHERE 1=1 AND LINK_ID = 'E3303' AND ITM_ID = 'T002' AND C1 = '00'
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3303')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3303' AND ITM_ID = 'T002' AND C1 = '00' 
		 <!-- 2020-04.14[곽제욱] 저임금 근로자 비율 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T002' 변경) END -->
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3303')
		</if>
		<if test="Link_id != null and Link_id == 'E3301'">
		SELECT '33' AS SECTION
			 , '평균임금총액' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , REPLACE(A.DT, ',', '') AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04.14[곽제욱] 평균임금총액 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index6' AND C1 = '00' 변경) START -->
			     WHERE 1=1 AND LINK_ID = 'E3301' AND ITM_ID = 'index6' AND C1 = '00'  
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3301')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3301' AND ITM_ID = 'index6' AND C1 = '00'
		 <!-- 2020-04.14[곽제욱] 평균임금총액 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index6' AND C1 = '00' 변경) END --> 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3301')
		</if>
	</select>
	
	<!-- 일자리질 > 현황조회 상세 > 차트 -->
	<select id="getStatsAnlsJobQualityDetailChart" parameterType="hashmap" resultType="hashmap">	
		/*getStatsAnlsJobQualityDetailChart*/
		<if test="Link_id != null and Link_id == 'E3309'">
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID, '산업재해 전체 재해율' AS LINK_NM
			 , C1 AS C1
			 , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04.14[곽제욱] 산업재해 전체 재해율 KOSIS 연계로 인한 조건절 수정(ITM_ID = '16118AAD6_15118AI8ACAB' AND C1 = '15118AI700' 변경) START -->
		 WHERE LINK_ID = 'E3309' AND ITM_ID = '16118AAD6_15118AI8ACAB' AND C1 = '15118AI700'
		 <!-- 2020-04.14[곽제욱] 산업재해 전체 재해율 KOSIS 연계로 인한 조건절 수정(ITM_ID = '16118AAD6_15118AI8ACAB' AND C1 = '15118AI700' 변경) END --> 
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'I3308'">
		SELECT CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN T_I3308.DT ELSE 0 END MON1
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN T_I3308.DT ELSE 0 END MON2
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN T_I3308.DT ELSE 0 END MON3
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN T_I3308.DT ELSE 0 END MON4
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN T_I3308.DT ELSE 0 END MON5
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN T_I3308.DT ELSE 0 END MON6
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN T_I3308.DT ELSE 0 END MON7
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN T_I3308.DT ELSE 0 END MON8
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN T_I3308.DT ELSE 0 END MON9
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN T_I3308.DT ELSE 0 END MON10
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN T_I3308.DT ELSE 0 END MON11
			 , CASE WHEN T_I3308.PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN T_I3308.DT ELSE 0 END MON12
			 , T_I3308.LINK_ID, '고용보험 가입률' AS LINK_NM
			 , T_I3308.PRD_DE
			 , C1 AS C1
			 , C1_NM AS C1_NM 
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT
			         , LINK_ID
					 , SUBSTR(PRD_DE, 1, 4) PRD_DE
					 , PRD_DE AS O_PRD_DE
				  FROM SRV_DT_KOSIS_DATA 
				 WHERE LINK_ID = 'I3308'
				   AND C1 = '00'
				   AND ITM_ID = 'T50' 
				   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
				) T_I3308
		 WHERE A.PRD_DE = T_I3308.O_PRD_DE
		   AND A.LINK_ID = 'I3308'
		   AND A.C1 = '00'
		   AND A.ITM_ID = 'T50' 
		   AND A.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'E3307'">
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID, '총 근로시간' AS LINK_NM
			 , C1 AS C1
			 , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA
		 <!-- 2020-04.14[곽제욱] 총 근로시간 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index2' AND C1 = '00' 변경) START --> 
		 WHERE LINK_ID = 'E3307' AND ITM_ID = 'index2' AND C1 = '00'
		 <!-- 2020-04.14[곽제욱] 총 근로시간 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index2' AND C1 = '00' 변경) END --> 
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'I3306'">
		SELECT CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN T_I3306.DT ELSE 0 END MON1
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN T_I3306.DT ELSE 0 END MON2
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN T_I3306.DT ELSE 0 END MON3
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN T_I3306.DT ELSE 0 END MON4
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN T_I3306.DT ELSE 0 END MON5
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN T_I3306.DT ELSE 0 END MON6
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN T_I3306.DT ELSE 0 END MON7
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN T_I3306.DT ELSE 0 END MON8
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN T_I3306.DT ELSE 0 END MON9
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN T_I3306.DT ELSE 0 END MON10
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN T_I3306.DT ELSE 0 END MON11
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN T_I3306.DT ELSE 0 END MON12
			 , T_I3306.LINK_ID, '근로자 수' AS LINK_NM
			 , T_I3306.PRD_DE 
			 , T_I3306.C1 AS C1
			 , T_I3306.C1_NM AS C1_NM
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT
			         , LINK_ID
					 , SUBSTR(PRD_DE, 1, 4) PRD_DE
					 , PRD_DE AS O_PRD_DE
					 , C1 AS C1
			 		 , C1_NM AS C1_NM
				  FROM SRV_DT_KOSIS_DATA 
				 WHERE LINK_ID = 'I3306'
				   AND C1 = '00'
				   AND ITM_ID = 'T03' 
				   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
				) T_I3306
		 WHERE A.PRD_DE = T_I3306.O_PRD_DE
		   AND A.LINK_ID = 'I3306' 
		   AND A.ITM_ID = 'T03' 
		   AND A.C1 = '00' 
		   AND A.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'I3306_1'">
		SELECT CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN T_I3306.DT ELSE 0 END MON1
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN T_I3306.DT ELSE 0 END MON2
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN T_I3306.DT ELSE 0 END MON3
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN T_I3306.DT ELSE 0 END MON4
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN T_I3306.DT ELSE 0 END MON5
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN T_I3306.DT ELSE 0 END MON6
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN T_I3306.DT ELSE 0 END MON7
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN T_I3306.DT ELSE 0 END MON8
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN T_I3306.DT ELSE 0 END MON9
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN T_I3306.DT ELSE 0 END MON10
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN T_I3306.DT ELSE 0 END MON11
			 , CASE WHEN T_I3306.PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN T_I3306.DT ELSE 0 END MON12
			 , T_I3306.LINK_ID, '근로자 비율' AS LINK_NM
			 , T_I3306.PRD_DE 
			 , T_I3306.C1 AS C1
			 , T_I3306.C1_NM AS C1_NM
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT TRUNC((NON_REGULAR.DT / TOTAL.DT) * 100, 1) DT
					 , 'I3306_1' AS LINK_ID
					 , SUBSTR(S.PRD_DE, 1, 4) PRD_DE
					 , S.PRD_DE AS O_PRD_DE
					 , S.C1 AS C1
			 		 , S.C1_NM AS C1_NM
				  FROM SRV_DT_KOSIS_DATA S
					 , (SELECT DT, PRD_DE FROM SRV_DT_KOSIS_DATA 
						 WHERE 1=1 AND LINK_ID = 'I3306' AND ITM_ID = 'T01' AND C1 = '00') TOTAL
					 , (SELECT DT, PRD_DE FROM SRV_DT_KOSIS_DATA 
						 WHERE 1=1 AND LINK_ID = 'I3306' AND ITM_ID = 'T03' AND C1 = '00') NON_REGULAR
				 WHERE S.PRD_DE = TOTAL.PRD_DE
				   AND TOTAL.PRD_DE = NON_REGULAR.PRD_DE
				   AND S.LINK_ID = 'I3306'
				   AND S.C1 = '00'
				   AND S.ITM_ID = 'T03' 
				   AND S.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
				) T_I3306
		 WHERE A.PRD_DE = T_I3306.O_PRD_DE
		   AND A.LINK_ID = 'I3306' 
		   AND A.ITM_ID = 'T03' 
		   AND A.C1 = '00' 
		   AND A.PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYYMM') AND TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'E3303'">
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID, '임금상승률' AS LINK_NM <!-- 2020-05-21 [곽제욱] 저임금 근로자 비율 -> 임금상승률 로 변경 -->
			 , C1 AS C1
			 , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04.14[곽제욱] 저임금 근로자 비율 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T002' 변경) START -->
		 WHERE LINK_ID = 'E3303' AND ITM_ID = 'T002' AND C1 = '00' 
		 <!-- 2020-04.14[곽제욱] 저임금 근로자 비율 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T002' 변경) END -->
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'E3301'">
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN REPLACE(DT, ',', '') ELSE 0 END MON12
			 , LINK_ID, '평균임금총액' AS LINK_NM
			 , C1 AS C1
			 , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04.14[곽제욱] 평균임금총액 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index6' AND C1 = '00' 변경) START -->
		 WHERE LINK_ID = 'E3301' AND ITM_ID = 'index6' AND C1 = '00' 
		 <!-- 2020-04.14[곽제욱] 평균임금총액 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'index6' AND C1 = '00' 변경) START -->
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		</if>
	</select>
	
	<!-- 경제상황 > 현황조회 메인 > 집계 -->
	<select id="getStatsAnlsEconomicSituationMain" parameterType="hashmap" resultType="hashmap">	
		/*getStatsAnlsEconomicSituationMain*/
		SELECT '34' AS SECTION
			 , '경제성장률' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'I3401' AND ITM_ID = 'T10' AND C1 = '00'
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3401')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3401' AND ITM_ID = 'T10' AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3401')
		 UNION ALL 
		SELECT '34' AS SECTION
			 , '지역내총생산' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'I3402' AND ITM_ID = 'T1' AND C1 = '00' AND C2 = 'Z10' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3402')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3402' AND ITM_ID = 'T1' AND C1 = '00' AND C2 = 'Z10' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3402')
		 UNION ALL 
		SELECT '34' AS SECTION
			 , '소비자물가지수' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'I3403' AND ITM_ID = 'T10' AND C1 = '00' 
				   AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3403')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3403' AND ITM_ID = 'T10' AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3403')
		 UNION ALL 
		SELECT '34' AS SECTION
			 , '생활물가지수' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04-21[곽제욱] 생활물가지수 KOSIS 연계로 인한 조건절 수정(C1 = '00' 변경) START -->
			     WHERE 1=1 AND LINK_ID = 'I3404' AND C1 = '00' 
				   AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3404')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3404' AND C1 = '00'
		 <!-- 2020-04-21[곽제욱] 생활물가지수 KOSIS 연계로 인한 조건절 수정(C1 = '00' 변경) END --> 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3404')
		 UNION ALL 
		SELECT '34' AS SECTION
			 , '수출' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA
		<!-- 2020-04-21 [곽제욱] 일자리통계 > 수출 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10'). START --> 
		     	 <!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. -->
			     WHERE 1=1 AND LINK_ID = 'I3405' AND ITM_ID = 'T10' AND C1 = '00'
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3405' AND ITM_ID = 'T10')
			   ) B
		<!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. -->
		 WHERE 1=1 AND LINK_ID = 'I3405' AND ITM_ID = 'T10' AND C1 = '00'		  
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3405' AND ITM_ID = 'T10')
	    <!-- 2020-04-21 [곽제욱] 일자리통계 > 수출 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10'). END -->
		 UNION ALL 
		SELECT '34' AS SECTION
			 , '수입' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04-21 [곽제욱] 일자리통계 > 수입 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10'). START --> 
		     	 <!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. -->
			     WHERE 1=1 AND LINK_ID = 'I3406' AND ITM_ID = 'T10' AND C1 = '00'
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3406' AND ITM_ID = 'T10')
			   ) B
		 <!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. -->
		 WHERE 1=1 AND LINK_ID = 'I3406' AND ITM_ID = 'T10' AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3406' AND ITM_ID = 'T10')
		 <!-- 2020-04-21 [곽제욱] 일자리통계 > 수입 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10'). START -->
	</select>
	
	<!-- 경제상황 > 현황조회 메인 > 차트 -->
	<select id="getStatsAnlsEconomicSituationMainChart" parameterType="hashmap" resultType="hashmap">	
		/*getStatsAnlsEconomicSituationMainChart*/
	    SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID
			 , '경제성장률' as LINK_NM
			 , PRD_DE
			 , UNIT_NM
		  FROM SRV_DT_KOSIS_DATA
		 where LINK_ID = 'I3401'
		   AND C1 = '00'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		 UNION ALL
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID
			 , '지역내총생산' as LINK_NM
			 , PRD_DE
			 , UNIT_NM
		  FROM SRV_DT_KOSIS_DATA
		 WHERE LINK_ID = 'I3402'
		   AND C1 = '00'
		   AND C2 = 'Z10'
		   AND ITM_ID = 'T1'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		 UNION ALL
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON12
			 , LINK_ID
			 , '소비자물가지수' as LINK_NM
			 , PRD_DE
             , NVL(UNIT_NM, '백만원') as UNIT_NM
		  FROM SRV_DT_KOSIS_DATA
		 WHERE LINK_ID = 'I3403'
		   AND C1 = '00'
		   AND ITM_ID = 'T10'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') and TO_CHAR(SYSDATE, 'YYYYMM')
		 UNION ALL
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON12
			 , LINK_ID
			 , '생활물가지수' as LINK_NM
			 , PRD_DE
			 , NVL(UNIT_NM, '백만원') as UNIT_NM
		  FROM SRV_DT_KOSIS_DATA
		 WHERE LINK_ID = 'I3404'
		 <!-- 2020-04-21[곽제욱] 생활물가지수 KOSIS 연계로 인한 조건절 수정(C1 = '00' 변경) START -->
		   AND C1 = '00'
		   AND C2 = '110'
		 <!-- 2020-04-21[곽제욱] 생활물가지수 KOSIS 연계로 인한 조건절 수정(C1 = '00' 변경) END -->
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') and TO_CHAR(SYSDATE, 'YYYYMM')
		 UNION ALL
		<!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. START -->
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID
			 , '수출' as LINK_NM
			 , PRD_DE
			 , UNIT_NM
		  FROM SRV_DT_KOSIS_DATA
		 WHERE LINK_ID = 'I3405'
		 <!-- 2020-04-21[곽제욱] 수출 KOSIS 연계로 인한 조건절 수정(C1 = '00' AND ITM_ID = 'T10' 변경) START -->
		   AND C1 = '00'
		   AND ITM_ID = 'T10'
		 <!-- 2020-04-21[곽제욱] 수출 KOSIS 연계로 인한 조건절 수정(C1 = '00' AND ITM_ID = 'T10' 변경) END -->
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		<!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. END -->
		 UNION ALL
		<!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. START -->
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID
			 , '수입' as LINK_NM
			 , PRD_DE
			 , UNIT_NM
		  FROM SRV_DT_KOSIS_DATA
		 WHERE LINK_ID = 'I3406'
		 <!-- 2020-04-21[곽제욱] 수입 KOSIS 연계로 인한 조건절 수정(C1 = '00' AND ITM_ID = 'T10' 변경) START -->
		   AND C1 = '00'
		   AND ITM_ID = 'T10'
		 <!-- 2020-04-21[곽제욱] 수입 KOSIS 연계로 인한 조건절 수정(C1 = '00' AND ITM_ID = 'T10' 변경) END -->  
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		<!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. END -->
	</select>
	
	<!-- 경제상황 > 현황조회 메인 > 데이터보드 -->
	<select id="getStatsAnlsEconomicSituationMainDataBoard" parameterType="hashmap" resultType="hashmap">	
		/*getStatsAnlsEconomicSituationMainDataBoard*/
		<if test="Link_id != null and Link_id == 'I3401'">
		select '34' as section
			 , '경제성장률' as itm_nm
			 , link_id as link_id
			 , dt as dt
			 , unit_nm as unit_nm
			 , C1 AS C1
			 , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  from srv_dt_kosis_data where 1=1 and link_id = 'I3401' 
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'I3402'">
		select '34' as section
			 , '지역내총생산' as itm_nm
			 , link_id as link_id
			 , dt as dt
			 , unit_nm as unit_nm
			 , C1 AS C1
			 , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  from srv_dt_kosis_data where 1=1 and link_id = 'I3402' and itm_id = 'T1' and c2 = 'Z10' 
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'I3403'"> 
		select '34' as section
			 , '소비자물가지수' as itm_nm
			 , link_id as link_id
			 , dt as dt
			 , unit_nm as unit_nm
			 , C1 AS C1
			 , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  from srv_dt_kosis_data where 1=1 and link_id = 'I3403' and itm_id = 'T10' 
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') and TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'I3404'"> 
		select '34' as section
			 , '생활물가지수' as itm_nm
			 , link_id as link_id
			 , dt as dt
			 , unit_nm as unit_nm
			 , C1 AS C1
			 , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		<!-- 2020-04-21[곽제욱] 생활물가지수 KOSIS 연계로 인한 조건절 수정(C1 삭제) START -->	 
		  from srv_dt_kosis_data where 1=1 and link_id = 'I3404' and c2 = '110'
		<!-- 2020-04-21[곽제욱] 생활물가지수 KOSIS 연계로 인한 조건절 수정(C1 삭제) END --> 
           and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') and TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'I3405'"> 
		select '34' as section
			 , '수출' as itm_nm
			 , link_id as link_id
			 , dt as dt
			 , unit_nm as unit_nm
			 , C1 AS C1
			 , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  <!-- 2020-04-21[곽제욱] 수출 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경) START -->
		  <!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. -->
		  from srv_dt_kosis_data where 1=1 and link_id = 'I3405' and itm_id = 'T10'
		  <!-- 2020-04-21[곽제욱] 수출 KOSIS 연계로 인한 조건절 수정(AND ITM_ID = 'T10' 변경) END --> 
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'I3406'"> 
		select '34' as section
			 , '수입' as itm_nm
			 , link_id as link_id
			 , dt as dt
			 , unit_nm as unit_nm
			 , C1 AS C1
			 , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  <!-- 2020-04-21[곽제욱] 수출 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경) START -->	 
		  <!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. -->
		  from srv_dt_kosis_data where 1=1 and link_id = 'I3406' and itm_id = 'T10' 
		  <!-- 2020-04-21[곽제욱] 수출 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경) END -->
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		</if>		
	</select>
	
	<!-- 경제상황 > 현황조회 상세 > 집계 -->
	<select id="getStatsAnlsEconomicSituationDetail" parameterType="hashmap" resultType="hashmap">	
		/* getStatsAnlsEconomicSituationDetail */
		<if test="Link_id != null and Link_id == 'I3401'">
		SELECT '34' AS SECTION
			 , '경제성장률' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
		     , A.PRD_DE AS PRD_DE
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'I3401' AND ITM_ID = 'T10' AND C1 = '00'
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3401')
			   ) B
		 wHERE 1=1 AND LINK_ID = 'I3401' AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3401')
		</if>
		<if test="Link_id != null and Link_id == 'I3402'">
		SELECT '34' AS SECTION
			 , '지역내총생산' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
		     , A.PRD_DE AS PRD_DE
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'I3402' AND ITM_ID = 'T1' AND C1 = '00' AND C2 = 'Z10' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3402')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3402' AND ITM_ID = 'T1' AND C1 = '00' AND C2 = 'Z10' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3402')
		</if>
		<if test="Link_id != null and Link_id == 'I3403'"> 
		SELECT '34' AS SECTION
			 , '소비자물가지수' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
		     , A.PRD_DE AS PRD_DE
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'I3403' AND ITM_ID = 'T10' AND C1 = '00' 
				   AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3403')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3403' AND ITM_ID = 'T10' AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3403')
		</if>
		<if test="Link_id != null and Link_id == 'I3404'"> 
		SELECT '34' AS SECTION
			 , '생활물가지수' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
		     , A.PRD_DE AS PRD_DE
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA
		 <!-- 2020-04-21[곽제욱] 생활물가지수 KOSIS 연계로 인한 조건절 수정(C1 = '00' 변경) START --> 
			     WHERE 1=1 AND LINK_ID = 'I3404' AND C1 = '00' AND C2 = '110' 
				   AND PRD_DE = (SELECT TO_CHAR(ADD_MONTHS(TO_DATE(MAX(PRD_DE),'YYYYMM'),-1),'YYYYMM') AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3404')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'I3404' AND C1 = '00' AND C2 = '110'
		 <!-- 2020-04-21[곽제욱] 생활물가지수 KOSIS 연계로 인한 조건절 수정(C1 = '00' 변경) END -->  
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3404')
		</if>
		<if test="Link_id != null and Link_id == 'I3405'"> 
		SELECT '34' AS SECTION
			 , '수출' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
		     , A.PRD_DE AS PRD_DE
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04-21[곽제욱] 수출 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경) START -->
		         <!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. -->
			     WHERE 1=1 AND LINK_ID = 'I3405' AND ITM_ID = 'T10' AND C1 = '00'
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3405' AND ITM_ID = 'T10')
			   ) B
		 <!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. -->
		 WHERE 1=1 AND LINK_ID = 'I3405' AND ITM_ID = 'T10' AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3405' AND ITM_ID = 'T10')
		 <!-- 2020-04-21[곽제욱] 수출 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경) END -->
		</if>
		<if test="Link_id != null and Link_id == 'I3406'"> 
		SELECT '34' AS SECTION
			 , '수입' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
		     , A.PRD_DE AS PRD_DE
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04-21[곽제욱] 수입 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경) START -->
		         <!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. -->
			     WHERE 1=1 AND LINK_ID = 'I3406' AND ITM_ID = 'T10' AND C1 = '00'
                   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3406' AND ITM_ID = 'T10')
			   ) B
	     <!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. -->
		 WHERE 1=1 AND LINK_ID = 'I3406' AND ITM_ID = 'T10' AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'I3406' AND ITM_ID = 'T10')
		 <!-- 2020-04-21[곽제욱] 수입 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경) END -->
		</if>			
	</select>
	
	<!-- 경제상황 > 현황조회 상세 > 차트 -->
	<select id="getStatsAnlsEconomicSituationDetailChart" parameterType="hashmap" resultType="hashmap">	
		/* getStatsAnlsEconomicSituationDetailChart */
		<if test="Link_id != null and Link_id == 'I3401'">
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID
			 , '경제성장률' as LINK_NM
			 , C1 AS C1
		     , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA
		 where LINK_ID = 'I3401'
		   AND C1 = '00'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'I3402'">
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID
			 , '지역내총생산' as LINK_NM
			 , C1 AS C1
		     , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA
		 WHERE LINK_ID = 'I3402'
		   AND C1 = '00'
		   AND C2 = 'Z10'
		   AND ITM_ID = 'T1'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'I3403'">
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON12
			 , LINK_ID
			 , '소비자물가지수' as LINK_NM
			 , C1 AS C1
		     , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA
		 WHERE LINK_ID = 'I3403'
		   AND C1 = '00'
		   AND ITM_ID = 'T10'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') and TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'I3404'">
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-11),'YYYYMM') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-10),'YYYYMM') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-9),'YYYYMM') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-8),'YYYYMM') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-7),'YYYYMM') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-6),'YYYYMM') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-5),'YYYYMM') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-4),'YYYYMM') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-3),'YYYYMM') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-2),'YYYYMM') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-1),'YYYYMM') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYYMM') THEN DT ELSE 0 END MON12
			 , LINK_ID
			 , '생활물가지수' as LINK_NM
			 , C1 AS C1
		     , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA
		 WHERE LINK_ID = 'I3404'
		 <!-- 2020-04-21[곽제욱] 생활물가지수 KOSIS 연계로 인한 조건절 수정(C1 = '00' 변경) START -->
		   AND C1 = '00'
		   AND C2 = '110'
		 <!-- 2020-04-21[곽제욱] 생활물가지수 KOSIS 연계로 인한 조건절 수정(C1 = '00' 변경) END -->
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYYMM') and TO_CHAR(SYSDATE, 'YYYYMM')
		</if>
		<if test="Link_id != null and Link_id == 'I3405'">
		<!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. START -->
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID
			 , '수출' as LINK_NM
			 , C1 AS C1
		     , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA
		 WHERE LINK_ID = 'I3405'
		   AND C1 = '00'
		   <!-- 2020-04-21[곽제욱] 수출 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경) START -->
		   AND ITM_ID = 'T10'
		   <!-- 2020-04-21[곽제욱] 수출 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경) END -->
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		<!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. END -->
		</if>
		<if test="Link_id != null and Link_id == 'I3406'">
		<!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. START -->
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID
			 , '수입' as LINK_NM
			 , C1 AS C1
		     , C1_NM AS C1_NM
			 , PRD_DE AS PRD_DE
		  FROM SRV_DT_KOSIS_DATA
		 WHERE LINK_ID = 'I3406'
		   AND C1 = '00'
		   <!-- 2020-04-21[곽제욱] 수입 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경) START -->
		   AND ITM_ID = 'T10'
		   <!-- 2020-04-21[곽제욱] 수입 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T10' 변경) END -->
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		<!-- 2020-02-24 [김남민] 일자리통계 > 수출, 수입 집계단위 (년월 => 년도) 수정. END -->
		</if>
	</select>
	
	<!-- 삶의질 > 현황조회 메인 > 집계 -->
	<select id="getStatsAnlsLifeQualityMain" parameterType="hashmap" resultType="hashmap">	
		/*getStatsAnlsLifeQualityMain*/
		SELECT '35' AS SECTION
			 , '삶에 대한 만족도' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA
		 <!-- 2020-04-22 [곽제욱] 삶에 대한 만족도 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T1' AND C1 = '10' 변경) START --> 
			     WHERE 1=1 AND LINK_ID = 'E3506' AND ITM_ID = 'T1' AND C1 = '10' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3506')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3506' AND ITM_ID = 'T1' AND C1 = '10'
		 <!-- 2020-04-22 [곽제욱] 삶에 대한 만족도 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T1' AND C1 = '10' 변경) END --> 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3506')
		 UNION ALL
		<!-- 2020-04-22 [곽제욱] 소비생활만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		SELECT '35' AS SECTION
			 , '소비생활만족도' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , SUM(TO_NUMBER(A.DT)) AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT SUM(TO_NUMBER(DT)) AS DT FROM SRV_DT_KOSIS_DATA
			     WHERE 1=1 AND LINK_ID = 'E3505' AND ITM_ID IN ('T11', 'T12') AND C1 = '00' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-2 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3505')
				GROUP BY LINK_ID
			   ) B 
		 WHERE 1=1 AND LINK_ID = 'E3505' AND ITM_ID IN ('T11', 'T12') AND C1 = '00'
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3505')
		 GROUP BY A.LINK_ID, A.UNIT_NM, A.C1, A.C1_NM, B.DT	 
		 <!-- 2020-04-22 [곽제욱] 소비생활만족도 KOSIS 연계로 인한 쿼리 수정 END -->
		 UNION ALL
		<!-- 2020-04-22 [곽제욱] 일자리만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		SELECT '35' AS SECTION
			 , '일자리만족도' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , SUM(TO_NUMBER(A.DT)) AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT SUM(TO_NUMBER(DT)) AS DT FROM SRV_DT_KOSIS_DATA
			     WHERE 1=1 AND LINK_ID = 'E3503' AND ITM_ID IN ('T11', 'T12') AND C1 = '00' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-2 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3503')
				GROUP BY LINK_ID
			   ) B 
		 WHERE 1=1 AND LINK_ID = 'E3503' AND ITM_ID IN ('T11', 'T12') AND C1 = '00'
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3503')
		 GROUP BY A.LINK_ID, A.UNIT_NM, A.C1, A.C1_NM, B.DT	 
		 <!-- 2020-04-22 [곽제욱] 일자리만족도 KOSIS 연계로 인한 쿼리 수정 END -->
		 UNION ALL
		<!-- 2020-04-22 [곽제욱] 소득만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		SELECT '35' AS SECTION
			 , '소득만족도' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , SUM(TO_NUMBER(A.DT)) AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT SUM(TO_NUMBER(DT)) AS DT FROM SRV_DT_KOSIS_DATA
			     WHERE 1=1 AND LINK_ID = 'E3504' AND ITM_ID IN ('T21', 'T22') AND C1 = '00' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-2 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3504')
				GROUP BY LINK_ID
			   ) B 
		 WHERE 1=1 AND LINK_ID = 'E3504' AND ITM_ID IN ('T21', 'T22') AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3504')
		 GROUP BY A.LINK_ID, A.UNIT_NM, A.C1, A.C1_NM, B.DT	 
		<!-- 2020-04-22 [곽제욱] 소득만족도 KOSIS 연계로 인한 쿼리 수정 END -->
		 UNION ALL
		SELECT '35' AS SECTION
			 , '상대적빈곤율' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'E3502' AND ITM_ID = 'T20' AND C1 = '00' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3502')
			   ) B 
		 WHERE 1=1 AND LINK_ID = 'E3502' AND ITM_ID = 'T20' AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3502')
		 UNION ALL
		SELECT '35' AS SECTION
			 , '지니계수' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'E3501' AND ITM_ID = 'T10' AND C1 = '00' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3501')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3501' AND ITM_ID = 'T10' AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3501')
	</select>
	
	<!-- 삶의질 > 현황조회 메인 > 차트 -->
	<select id="getStatsAnlsLifeQualityMainChart" parameterType="hashmap" resultType="hashmap">	
		/*getStatsAnlsLifeQualityMainChart*/
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID, '삶에 대한 만족도' as LINK_NM
			 , PRD_DE 
			 , UNIT_NM
			 , C1 AS C1
			 , C1_NM AS C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04-22 [곽제욱] 삶에 대한 만족도 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T1' AND C1 = '10' 변경) START --> 
		 where LINK_ID = 'E3506' and itm_id = 'T1' and c1 = '10'
		 <!-- 2020-04-22 [곽제욱] 삶에 대한 만족도 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T1' AND C1 = '10' 변경) END --> 
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		 UNION ALL 
		 <!-- 2020-04-22 [곽제욱] 소비생활만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		 SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON12
			 , LINK_ID, '소비생활만족도' as LINK_NM
			 , PRD_DE 
			 , UNIT_NM
			 , C1 AS C1
			 , C1_NM AS C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 where LINK_ID = 'E3505' and itm_id in ('T11', 'T12') and c1 = '00'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		 GROUP BY LINK_ID, UNIT_NM, C1, C1_NM, PRD_DE
		 <!-- 2020-04-22 [곽제욱] 소비생활만족도 KOSIS 연계로 인한 쿼리 수정 END -->
		 UNION ALL 
		<!-- 2020-04-22 [곽제욱] 일자리만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON12
			 , LINK_ID, '일자리만족도' as LINK_NM
			 , PRD_DE 
			 , UNIT_NM
			 , C1 AS C1
			 , C1_NM AS C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 where LINK_ID = 'E3503' and itm_id in ('T11', 'T12') and c1 = '00'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		 GROUP BY LINK_ID, UNIT_NM, C1, C1_NM, PRD_DE
		 <!-- 2020-04-22 [곽제욱] 일자리만족도 KOSIS 연계로 인한 쿼리 수정 END -->
		 UNION ALL 
		<!-- 2020-04-22 [곽제욱] 소득만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON12
			 , LINK_ID, '소득만족도' as LINK_NM
			 , PRD_DE 
			 , UNIT_NM
			 , C1 AS C1
			 , C1_NM AS C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 where LINK_ID = 'E3504' and itm_id in ('T21', 'T22') and c1 = '00'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		 GROUP BY LINK_ID, UNIT_NM, C1, C1_NM, PRD_DE
		 <!-- 2020-04-22 [곽제욱] 소득만족도 KOSIS 연계로 인한 쿼리 수정 END -->  
		 UNION ALL 
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID, '상대적 빈곤율' as LINK_NM
			 , PRD_DE 
			 , UNIT_NM
			 , C1 AS C1
			 , C1_NM AS C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'E3502' and itm_id = 'T20' and c1 = '00' 
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		 UNION ALL 
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID, '지니계수' as LINK_NM
			 , PRD_DE 
			 , UNIT_NM
			 , C1 AS C1
			 , C1_NM AS C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'E3501' and itm_id = 'T10' and c1 = '00' 
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
	</select>
	
	<!-- 삶의질 > 현황조회 메인 > 데이터보드 -->
	<select id="getStatsAnlsLifeQualityMainDataBoard" parameterType="hashmap" resultType="hashmap">	
		<if test="Link_id != null and Link_id == 'E3506'">
		select '35' as section
			 , '삶에 대한 만족도' as itm_nm
			 , link_id as link_id
			 , dt as dt
			 , unit_nm as unit_nm
			 , c1 as c1
			 , c1_nm as c1_nm
			 , prd_de as prd_de
		  <!-- 2020-04-22 [곽제욱] 삶에 대한 만족도 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T1' 변경) START --> 	
		  from srv_dt_kosis_data where 1=1 and link_id = 'E3506' and itm_id = 'T1'
		  <!-- 2020-04-22 [곽제욱] 삶에 대한 만족도 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T1' 변경) END -->  
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'E3505'">
		<!-- 2020-04-24 [곽제욱] 소비생활만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		select '35' as section
			 , '소비생활만족도' as itm_nm
			 , link_id as link_id
			 , SUM(TO_NUMBER(dt)) as dt
			 , unit_nm as unit_nm
			 , c1 as c1
			 , c1_nm as c1_nm
			 , prd_de as prd_de
		  from srv_dt_kosis_data where 1=1 and link_id = 'E3505' and itm_id IN ('T11', 'T12')
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		  GROUP BY link_id, unit_nm, c1, c1_nm, prd_de
		<!-- 2020-04-24 [곽제욱] 소비생활만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		</if>
		<if test="Link_id != null and Link_id == 'E3503'">
		<!-- 2020-04-24 [곽제욱] 일자리만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		select '35' as section
			 , '일자리만족도' as itm_nm
			 , link_id as link_id
			 , SUM(TO_NUMBER(dt)) as dt
			 , unit_nm as unit_nm
			 , c1 as c1
			 , c1_nm as c1_nm
			 , prd_de as prd_de
		  from srv_dt_kosis_data where 1=1 and link_id = 'E3503' and itm_id IN ('T11', 'T12')
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		  GROUP BY link_id, unit_nm, c1, c1_nm, prd_de
		  ORDER BY prd_de, c1
		<!-- 2020-04-24 [곽제욱] 일자리만족도 KOSIS 연계로 인한 쿼리 수정 END -->
		</if>
		<if test="Link_id != null and Link_id == 'E3504'">
		<!-- 2020-04-24 [곽제욱] 소득만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		select '35' as section
			 , '소득만족도' as itm_nm
			 , link_id as link_id
			 , SUM(TO_NUMBER(dt)) as dt
			 , unit_nm as unit_nm
			 , c1 as c1
			 , c1_nm as c1_nm
			 , prd_de as prd_de
		  from srv_dt_kosis_data where 1=1 and link_id = 'E3504' and itm_id IN ('T21', 'T22')
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		  GROUP BY link_id, unit_nm, c1, c1_nm, prd_de
		<!-- 2020-04-24 [곽제욱] 소득만족도 KOSIS 연계로 인한 쿼리 수정 END -->
		</if>
		<if test="Link_id != null and Link_id == 'E3502'">
		select '35' as section
			 , '상대적빈곤율' as itm_nm
			 , link_id as link_id
			 , dt as dt
			 , unit_nm as unit_nm
			 , c1 as c1
			 , c1_nm as c1_nm
			 , prd_de as prd_de
		  from srv_dt_kosis_data where 1=1 and link_id = 'E3502' and itm_id = 'T20' 
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'E3501'">
		select '35' as section
			 , '지니계수' as itm_nm
			 , link_id as link_id
			 , dt as dt
			 , unit_nm as unit_nm
			 , c1 as c1
			 , c1_nm as c1_nm
			 , prd_de as prd_de
		  from srv_dt_kosis_data where 1=1 and link_id = 'E3501' and itm_id = 'T10' 
		   AND PRD_DE BETWEEN TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') AND TO_CHAR(SYSDATE, 'YYYY')
		</if>			
	</select>
	
	<!-- 삶의질 > 현황조회 상세 > 집계 -->
	<select id="getStatsAnlsLifeQualityDetail" parameterType="hashmap" resultType="hashmap">	
		<if test="Link_id != null and Link_id == 'E3506'">
		SELECT '35' AS SECTION
			 , '삶에 대한 만족도' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04-24 [곽제욱] 삶에 대한 만족도 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T1' AND C1 = '10' 변경) START --> 
			     WHERE 1=1 AND LINK_ID = 'E3506' AND ITM_ID = 'T1' AND C1 = '10' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3506')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3506' AND ITM_ID = 'T1' AND C1 = '10' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3506')
		 <!-- 2020-04-24 [곽제욱] 삶에 대한 만족도 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T1' AND C1 = '10' 변경) END --> 
		</if>
		<if test="Link_id != null and Link_id == 'E3505'">
		<!-- 2020-04-24 [곽제욱] 소비생활만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		SELECT '35' AS SECTION
			 , '소비생활만족도' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , SUM(TO_NUMBER(A.DT)) AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT SUM(TO_NUMBER(DT)) AS DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'E3505' AND ITM_ID IN ('T11', 'T12') AND C1 = '00' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-2 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3505')
				 GROUP BY LINK_ID
			   ) B 
		 WHERE 1=1 AND LINK_ID = 'E3505' AND ITM_ID IN ('T11', 'T12') AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3505')
		 GROUP BY LINK_ID, UNIT_NM, C1, C1_NM, B.DT	
		<!-- 2020-04-24 [곽제욱] 소비생활만족도 KOSIS 연계로 인한 쿼리 수정 END -->
		</if>
		<if test="Link_id != null and Link_id == 'E3503'">
		<!-- 2020-04-24 [곽제욱] 일자리만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		SELECT '35' AS SECTION
			 , '일자리만족도' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , SUM(TO_NUMBER(A.DT)) AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT SUM(TO_NUMBER(DT)) AS DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'E3503' AND ITM_ID IN ('T11', 'T12') AND C1 = '00' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-2 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3503')
				 GROUP BY LINK_ID
			   ) B 
		 WHERE 1=1 AND LINK_ID = 'E3503' AND ITM_ID IN ('T11', 'T12') AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3503')
		 GROUP BY LINK_ID, UNIT_NM, C1, C1_NM, B.DT
		<!-- 2020-04-24 [곽제욱] 일자리만족도 KOSIS 연계로 인한 쿼리 수정 END -->
		</if>
		<if test="Link_id != null and Link_id == 'E3504'">
		<!-- 2020-04-24 [곽제욱] 소득만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		SELECT '35' AS SECTION
			 , '소득만족도' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , SUM(TO_NUMBER(A.DT)) AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT SUM(TO_NUMBER(DT)) AS DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'E3504' AND ITM_ID IN ('T21', 'T22') AND C1 = '00' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-2 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3504')
				 GROUP BY LINK_ID
			   ) B 
		 WHERE 1=1 AND LINK_ID = 'E3504' AND ITM_ID IN ('T21', 'T22') AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3504')
		 GROUP BY LINK_ID, UNIT_NM, C1, C1_NM, B.DT		
		<!-- 2020-04-24 [곽제욱] 소득만족도 KOSIS 연계로 인한 쿼리 수정 END -->
		</if>
		<if test="Link_id != null and Link_id == 'E3502'">
		SELECT '35' AS SECTION
			 , '상대적빈곤율' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'E3502' AND ITM_ID = 'T20' AND C1 = '00' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3502')
			   ) B 
		 WHERE 1=1 AND LINK_ID = 'E3502' AND ITM_ID = 'T20' AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3502')
		</if>
		<if test="Link_id != null and Link_id == 'E3501'">
		SELECT '35' AS SECTION
			 , '지니계수' AS ITM_NM
			 , A.LINK_ID AS LINK_ID
		     , A.DT AS DT
		     , A.UNIT_NM AS UNIT_NM
		     , A.C1 AS C1
		     , A.C1_NM AS C1_NM
			 , B.DT AS PRE_DT
		  FROM SRV_DT_KOSIS_DATA A
		     , (SELECT DT FROM SRV_DT_KOSIS_DATA 
			     WHERE 1=1 AND LINK_ID = 'E3501' AND ITM_ID = 'T10' AND C1 = '00' 
				   AND PRD_DE = (SELECT MAX(PRD_DE)-1 AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3501')
			   ) B
		 WHERE 1=1 AND LINK_ID = 'E3501' AND ITM_ID = 'T10' AND C1 = '00' 
		   AND PRD_DE = (SELECT MAX(PRD_DE) AS PRD_DE FROM SRV_DT_KOSIS_DATA WHERE LINK_ID = 'E3501')
		</if>
	</select>
	
	<!-- 삶의질 > 현황조회 상세 > 차트 -->
	<select id="getStatsAnlsLifeQualityDetailChart" parameterType="hashmap" resultType="hashmap">	
		/*getStatsAnlsLifeQualityDetailChart*/
		<if test="Link_id != null and Link_id == 'E3506'">
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID, '삶에 대한 만족도' as LINK_NM
			 , PRD_DE 
			 , C1 AS C1
			 , C1_NM AS C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 <!-- 2020-04-22 [곽제욱] 삶에 대한 만족도 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T1' 변경) START --> 
		 where LINK_ID = 'E3506' and itm_id = 'T1'
		 <!-- 2020-04-22 [곽제욱] 삶에 대한 만족도 KOSIS 연계로 인한 조건절 수정(ITM_ID = 'T1' 변경) END --> 
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'E3505'">
		<!-- 2020-04-24 [곽제욱] 소비생활만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON12
			 , LINK_ID, '소비생활만족도' as LINK_NM
			 , PRD_DE 
			 , C1 AS C1
			 , C1_NM AS C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'E3505' and itm_id IN ('T11', 'T12') AND C1 = '00'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		 GROUP BY LINK_ID, PRD_DE, C1, C1_NM
		<!-- 2020-04-24 [곽제욱] 소비생활만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		</if>
		<if test="Link_id != null and Link_id == 'E3503'">
		<!-- 2020-04-24 [곽제욱] 일자리만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON12
			 , LINK_ID, '일자리만족도' as LINK_NM
			 , PRD_DE 
			 , C1 AS C1
			 , C1_NM AS C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'E3503' and itm_id IN ('T11', 'T12') AND C1 = '00'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		 GROUP BY LINK_ID, PRD_DE, C1, C1_NM
		<!-- 2020-04-24 [곽제욱] 일자리만족도 KOSIS 연계로 인한 쿼리 수정 END -->
		</if>
		<if test="Link_id != null and Link_id == 'E3504'">
		<!-- 2020-04-24 [곽제욱] 소득만족도 KOSIS 연계로 인한 쿼리 수정 START -->
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN SUM(TO_NUMBER(DT)) ELSE 0 END MON12
			 , LINK_ID, '소득만족도' as LINK_NM
			 , PRD_DE 
			 , C1 AS C1
			 , C1_NM AS C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'E3504' and itm_id IN ('T21', 'T22') AND C1 = '00'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		 GROUP BY LINK_ID, PRD_DE, C1, C1_NM
		 <!-- 2020-04-24 [곽제욱] 소득만족도 KOSIS 연계로 인한 쿼리 수정 END -->
		</if>
		<if test="Link_id != null and Link_id == 'E3502'">
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID, '상대적 빈곤율' as LINK_NM
			 , PRD_DE 
			 , C1 AS C1
			 , C1_NM AS C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'E3502' and itm_id = 'T20'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		</if>
		<if test="Link_id != null and Link_id == 'E3501'">
		SELECT CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') THEN DT ELSE 0 END MON1
		     , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-120),'YYYY') THEN DT ELSE 0 END MON2
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-108),'YYYY') THEN DT ELSE 0 END MON3
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-96),'YYYY') THEN DT ELSE 0 END MON4
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-84),'YYYY') THEN DT ELSE 0 END MON5
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-72),'YYYY') THEN DT ELSE 0 END MON6
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-60),'YYYY') THEN DT ELSE 0 END MON7
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-48),'YYYY') THEN DT ELSE 0 END MON8
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-36),'YYYY') THEN DT ELSE 0 END MON9
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-24),'YYYY') THEN DT ELSE 0 END MON10
			 , CASE WHEN PRD_DE = TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-12),'YYYY') THEN DT ELSE 0 END MON11
			 , CASE WHEN PRD_DE = TO_CHAR(SYSDATE, 'YYYY') THEN DT ELSE 0 END MON12
			 , LINK_ID, '지니계수' as LINK_NM
			 , PRD_DE 
			 , C1 AS C1
			 , C1_NM AS C1_NM
		  FROM SRV_DT_KOSIS_DATA 
		 WHERE LINK_ID = 'E3501' and itm_id = 'T10'
		   and prd_de between TO_CHAR(ADD_MONTHS(TO_DATE(SYSDATE),-132),'YYYY') and TO_CHAR(SYSDATE, 'YYYY')
		</if>
	</select>

</mapper>
